(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.AuthorizationStorage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AuthorizationStorage=b())}else{nf.AuthorizationStorage=b()}}}(this,function(){var b="Access-Token-Expiration";var a=new RegExp("Request-Token=([^;]+)");return{getRequestToken:function(){var c=null;var d=a.exec(document.cookie);if(d){c=d[1]}return c},getToken:function(){return sessionStorage.getItem(b)},hasToken:function(){var c=this.getToken();return typeof c==="string"},removeToken:function(){sessionStorage.removeItem(b)},setToken:function(c){sessionStorage.setItem(b,c)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.AuthorizationStorage","lodash-core","moment"],function(f,e,c,d,g){return(nf.Common=b(f,e,c,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.AuthorizationStorage"),require("lodash-core"),require("moment")))}else{nf.Common=b(a.$,a.d3,a.nf.AuthorizationStorage,a._,a.moment)}}}(this,function(f,e,b,c,h){f(document).ready(function(){var i="images/bg-error.png";f("<img/>").attr("src",i).on("load",function(){f("div.message-pane").css("background-image",i)});f(document).on("mouseenter","span.link",function(){f(this).addClass("link-over")}).on("mouseleave","span.link",function(){f(this).removeClass("link-over")});f(document).on("click","div.nf-checkbox",function(){var k=f(this);var j=k.hasClass("checkbox-unchecked");if(j){k.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{k.removeClass("checkbox-checked").addClass("checkbox-unchecked")}k.trigger("change",{isChecked:j})});f(document).on("click",".nf-checkbox-label",function(j){f(j.target).parent().find(".nf-checkbox").click()});f(document).ajaxStart(function(){f("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){f("div.loading-container").removeClass("ajax-loading")});if(b.hasToken()){f("#user-logout-container").css("display","block");g.scheduleTokenRefresh()}f("#user-logout").on("click",function(){f.ajax({type:"DELETE",url:"../nifi-api/access/logout",}).done(function(){b.removeToken();window.location="../nifi/logout"}).fail(nfErrorHandler.handleAjaxError)});f("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi/"}else{window.location="../nifi/"}})});var d=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Reporting Tasks, Controller Services, Parameter Contexts, and Nodes in the Cluster"},{text:"access parameter contexts",value:"parameter-contexts",description:"Allows users to view/modify Parameter Contexts"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var g={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(i){f(this).slideDown(100)}},hide:{effect:function(i){f(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(j,t){if(j===t){return 0}var p=j.split(/-/);var u=t.split(/-/);if(p.length>=1&&u.length>=1){var r=p[0].split(/\./);var o=u[0].split(/\./);if(r.length>=1&&o.length>=1){var m=Math.min(r.length,o.length);for(var n=0;n<m;n++){var s=parseInt(r[n],10);var l=parseInt(o[n],10);if(isNaN(s)&&isNaN(l)){continue}else{if(isNaN(s)){return -1}else{if(isNaN(l)){return 1}}}if(s!==l){return s-l}}if(r.length===o.length){if(p.length===u.length){var q=g.substringAfterFirst(j,p[0]);var k=g.substringAfterFirst(t,u[0]);return q===k?0:q>k?1:-1}else{return u.length-p.length}}else{return r.length-o.length}}else{if(r.length>=1){return 1}else{if(o.length>=1){return -1}else{return 0}}}}else{if(p.length>=1){return 1}else{if(u.length>=1){return -1}else{return 0}}}},sortType:function(i,l){var j=function(o,m){var p=g.formatBundle(o.bundle);var n=g.formatBundle(m.bundle);return p===n?0:p>n?1:-1};var k=function(t,s){if(i.columnId==="version"){var r=g.isDefinedAndNotNull(t.bundle[i.columnId])?t.bundle[i.columnId]:"";var p=g.isDefinedAndNotNull(s.bundle[i.columnId])?s.bundle[i.columnId]:"";var n=g.sortVersion(r,p);return n===0?j(t,s):n}else{if(i.columnId==="type"){var q=g.substringAfterLast(t[i.columnId],".");var o=g.substringAfterLast(s[i.columnId],".");return q===o?0:q>o?1:-1}else{var m=g.isDefinedAndNotNull(t[i.columnId])?t[i.columnId]:"";var u=g.isDefinedAndNotNull(s[i.columnId])?s[i.columnId]:"";return m===u?j(t,s):m>u?1:-1}}};l.sort(k,i.sortAsc)},typeFormatter:function(n,j,m,l,i){var k="";if(i.restricted===true){k+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}else{k+='<div class="fa"></div>'}k+=g.escapeHtml(m);return k},genericValueFormatter:function(m,j,l,k,i){return g.escapeHtml(l)},typeBundleFormatter:function(m,j,l,k,i){return g.escapeHtml(g.formatBundle(i.bundle))},typeVersionFormatter:function(n,j,m,l,i){var k="";if(g.isDefinedAndNotNull(i.bundle)){k+=('<div style="float: left;">'+g.escapeHtml(i.bundle.version)+"</div>")}else{k+='<div style="float: left;">unversioned</div>'}if(!g.isEmpty(i.controllerServiceApis)){k+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}k+='<div class="clear"></div>';return k},instanceTypeFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.escapeHtml(g.formatType(i.component))},instanceBundleFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.typeBundleFormatter(m,j,l,k,i.component)},getVersionControlTooltip:function(i){return i.stateExplanation},formatClassName:function(i){return g.substringAfterLast(i.type,".")},formatType:function(i){var j=g.formatClassName(i);if(i.bundle.version!=="unversioned"){j+=(" "+i.bundle.version)}return j},formatBundle:function(i){var j="";if(i.group!=="default"){j=i.group+" - "}return j+i.artifact},setCurrentUser:function(i){g.currentUser=i},scheduleTokenRefresh:function(){if(d!==null){clearInterval(d)}var i=g.MILLIS_PER_MINUTE;var j=function(){var o=b.getToken();if(o!==null){var l=parseInt(o,10)*g.MILLIS_PER_SECOND;var n=new Date(l);var m=new Date();var k=n.valueOf()-m.valueOf()-(30*g.MILLIS_PER_SECOND);if(k<i){if(f("#current-user").text()!==g.ANONYMOUS_USER_TEXT&&!f("#anonymous-user-alert").is(":visible")){f("#anonymous-user-alert").show().qtip(f.extend({},g.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};j();d=setInterval(j,i)},setAnonymousUserLabel:function(){var i=f("#anonymous-user-alert");if(i.data("qtip")){i.qtip("api").destroy(true)}i.show().qtip(f.extend({},g.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));f("#current-user").text(g.ANONYMOUS_USER_TEXT).show()},getSessionExpiration:function(j){var k=null;var i=g.getJwtPayload(j);if(i){k=i.exp}return k},getDefaultExpiration:function(){var j=new Date();var i=j.getTime()+43200000;var k=Math.round(i/1000);return k.toString()},getJwtPayload:function(j){if(g.isDefinedAndNotNull(j)){var i=j.split(/\./);if(i.length!==3){return""}var l=f.base64.atob(i[1]);var k=JSON.parse(l);if(g.isDefinedAndNotNull(k)){return k}else{return null}}return null},canVersionFlows:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(j){if(g.isDefinedAndNotNull(g.currentUser)){if(g.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var i=function(m){if(g.isEmpty(g.currentUser.componentRestrictionPermissions)){return false}var l=false;f.each(g.currentUser.componentRestrictionPermissions,function(n,o){if(o.requiredPermission.id===m.id){if(o.permissions.canWrite===true){l=true;return false}}});return l};var k=true;if(g.isEmpty(j)){k=false}else{f.each(j,function(l,m){if(!i(m.requiredPermission)){k=false;return false}})}return k}else{return false}},canAccessCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true&&g.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true&&g.currentUser.tenantsPermissions.canWrite===true}else{return false}},canModifyParameterContexts:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.parameterContextPermissions.canRead===true&&g.currentUser.parameterContextPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true&&g.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true&&g.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(i,k,j){f(document).on("mouseenter",i,function(){f(this).removeClass(k).addClass(j)}).on("mouseleave",i,function(){f(this).removeClass(j).addClass(k)});return f(i).addClass(k)},toggleScrollable:function(i){if(f(i).is(":visible")){if(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth){f(i).addClass("scrollable")}else{f(i).removeClass("scrollable")}}},determineContrastColor:function(i){if(parseInt(i,16)>16777215/1.5){return"#000000"}return"#ffffff"},updateLogoutLink:function(){if(b.hasToken()){f("#user-logout-container").css("display","block")}else{f("#user-logout-container").css("display","none")}},isContentViewConfigured:function(){var i=f("#nifi-content-viewer-url").text();return !g.isBlank(i)},populateField:function(j,i){if(g.isUndefined(i)||g.isNull(i)){return f("#"+j).addClass("unset").text("No value set")}else{if(i===""){return f("#"+j).addClass("blank").text("Empty string set")}else{return f("#"+j).text(i)}}},clearField:function(i){return f("#"+i).removeClass("unset blank").text("")},cleanUpTooltips:function(i,j){i.find(j).each(function(){var l=f(this);if(l.data("qtip")){var k=l.qtip("api");k.destroy(true)}})},formatPropertyTooltip:function(j,l){var m=[];if(g.isDefinedAndNotNull(j)){if(!g.isBlank(j.description)){m.push(g.escapeHtml(j.description))}if(!g.isBlank(j.defaultValue)){m.push("<b>Default value:</b> "+g.escapeHtml(j.defaultValue))}if(!g.isBlank(j.supportsEl)){m.push("<b>Expression language scope:</b> "+g.escapeHtml(j.expressionLanguageScope))}if(!g.isBlank(j.sensitive)){m.push("<b>Sensitive property:</b> "+g.escapeHtml(j.sensitive))}if(!g.isBlank(j.identifiesControllerService)){var i=g.formatType({type:j.identifiesControllerService,bundle:j.identifiesControllerServiceBundle});var k=g.formatBundle(j.identifiesControllerServiceBundle);m.push("<b>Requires Controller Service:</b> "+g.escapeHtml(i+" from "+k))}}if(g.isDefinedAndNotNull(l)){if(!g.isEmpty(l.previousValues)){var n=[];f.each(l.previousValues,function(p,o){n.push("<li>"+g.escapeHtml(o.previousValue)+" - "+g.escapeHtml(o.timestamp)+" ("+g.escapeHtml(o.userIdentity)+")</li>")});m.push('<b>History:</b><ul class="property-info">'+n.join("")+"</ul>")}}if(m.length>0){return m.join("<br/><br/>")}else{return null}},formatProperty:function(i,j){return'<div><span class="label">'+g.formatValue(i)+": </span>"+g.formatValue(j)+"</div>"},formatValue:function(i){if(g.isDefinedAndNotNull(i)){if(i===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return g.escapeHtml(i)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(j){if(g.isDefinedAndNotNull(j)){return String(j).replace(/[&<>"'\/]/g,function(k){return i[k]})}else{return""}}}()),isSensitiveProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.sensitive===true}else{return false}},isRequiredProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.required===true}else{return false}},isDynamicProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.dynamic===true}else{return false}},getAllowableValues:function(i){if(g.isDefinedAndNotNull(i)){return i.allowableValues}else{return null}},supportsEl:function(i){if(g.isDefinedAndNotNull(i)){return i.supportsEl===true}else{return false}},formatUnorderedList:function(j){if(f.isArray(j)){var i=f('<ul class="result"></ul>');f.each(j,function(l,m){var k=f("<li></li>").appendTo(i);if(m instanceof jQuery){k.append(m)}else{k.text(m)}});return i}else{return null}},substringAfterLast:function(m,l){var j="";var k=m.lastIndexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringAfterFirst:function(m,l){var j="";var k=m.indexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringBeforeLast:function(l,k){var i="";var j=l.lastIndexOf(k);if(j>=0){i=l.substr(0,j)}return i},substringBeforeFirst:function(l,k){var i="";var j=l.indexOf(k);if(j>=0){i=l.substr(0,j)}return i},setCursor:function(j,i){if(i){f("#"+j).addClass("pointer")}else{f("#"+j).removeClass("pointer")}},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion. However, if a node in the cluster is not able to receive data as fast as other nodes, that node may be skipped in one or more iterations in order to maximize throughput of data distribution across the cluster."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(l){l=l<1?0:l;var n=l/g.MILLIS_PER_DAY;n=n>=1?parseInt(n,10):0;l%=g.MILLIS_PER_DAY;var i=l/g.MILLIS_PER_HOUR;i=i>=1?parseInt(i,10):0;l%=g.MILLIS_PER_HOUR;var j=l/g.MILLIS_PER_MINUTE;j=j>=1?parseInt(j,10):0;l%=g.MILLIS_PER_MINUTE;var m=l/g.MILLIS_PER_SECOND;m=m>=1?parseInt(m,10):0;l=Math.floor(l%g.MILLIS_PER_SECOND);var k=g.pad(i,2,"0")+":"+g.pad(j,2,"0")+":"+g.pad(m,2,"0")+"."+g.pad(l,3,"0");if(n>0){return n+" days and "+k}else{return k}},formatPredictedDuration:function(i){if(i===0){return"now"}return h.duration(i,"ms").humanize()},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(j){var i=parseFloat(j/g.BYTES_IN_TERABYTE);if(i>1){return i.toFixed(2)+" TB"}i=parseFloat(j/g.BYTES_IN_GIGABYTE);if(i>1){return i.toFixed(2)+" GB"}i=parseFloat(j/g.BYTES_IN_MEGABYTE);if(i>1){return i.toFixed(2)+" MB"}i=parseFloat(j/g.BYTES_IN_KILOBYTE);if(i>1){return i.toFixed(2)+" KB"}return parseFloat(j).toFixed(2)+" bytes"},formatInteger:function(j){var i=j+"";var k=/(\d+)(\d{3})/;while(k.test(i)){i=i.replace(k,"$1,$2")}return g.escapeHtml(i)},formatFloat:function(i){if(g.isUndefinedOrNull(i)){return 0+""}return i.toFixed(2)+""},pad:function(l,j,k){var i=l+"";while(i.length<j){i=k+i}return i},formatDateTime:function(i){return g.pad(i.getMonth()+1,2,"0")+"/"+g.pad(i.getDate(),2,"0")+"/"+g.pad(i.getFullYear(),2,"0")+" "+g.pad(i.getHours(),2,"0")+":"+g.pad(i.getMinutes(),2,"0")+":"+g.pad(i.getSeconds(),2,"0")+"."+g.pad(i.getMilliseconds(),3,"0")},parseDateTime:function(m){if(!g.isDefinedAndNotNull(m)){return new Date()}if(m==="No value set"){return new Date()}if(m==="Empty string set"){return new Date()}var t=m.split(/ /);if(t.length!==3){return new Date()}var j=t[0].split(/\//);var i=t[1].split(/:/);if(j.length!==3||i.length!==3){return new Date()}var o=parseInt(j[2],10);var n=parseInt(j[0],10)-1;var p=parseInt(j[1],10);var q=parseInt(i[0],10);var l=parseInt(i[1],10);var s=i[2].split(/\./);var r=parseInt(s[0],10);var k=0;if(s.length===2){k=parseInt(s[1],10)}return new Date(o,n,p,q,l,r,k)},parseDuration:function(i){var j=i.split(/:/);if(j.length!==3){return 0}var k=j[2].split(/\./);if(k.length===2){return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(k[0],10),parseInt(k[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10),0).getTime()}},parseSize:function(k){var l=k.split(/ /);var j=parseFloat(l[0].replace(/,/g,""));var i=l[1];if(i==="KB"){return j*1024}else{if(i==="MB"){return j*1024*1024}else{if(i==="GB"){return j*1024*1024*1024}else{if(i==="TB"){return j*1024*1024*1024*1024}else{return j}}}}},parseCount:function(k){var j=k.split(/ /,1);if(j.length!==1){return 0}var i=parseInt(j[0].replace(/,/g,""),10);if(isNaN(i)){return 0}return i},isDefinedAndNotNull:function(i){return !g.isUndefined(i)&&!g.isNull(i)},isUndefinedOrNull:function(i){return g.isUndefined(i)||g.isNull(i)},isUndefined:function(i){return typeof i==="undefined"},isBlank:function(i){return g.isUndefined(i)||g.isNull(i)||f.trim(i)===""},isNull:function(i){return i===null},isEmpty:function(i){return f.isArray(i)?i.length===0:true},doBulletinsDiffer:function(k,l){if(f.isArray(k)&&f.isArray(l)){if(k.length===l.length){for(var j=0;j<k.length;j++){if(k[j].id!==l[j].id||k[j].canRead!==l[j].canRead){return true}}}else{return true}}else{if(f.isArray(k)||f.isArray(l)){return true}}return false},getFormattedBulletins:function(j){var i=[];f.each(j,function(l,m){if(m.canRead===true){var k=m.bulletin;var p="";if(g.isDefinedAndNotNull(k.nodeAddress)){p="-&nbsp;"+g.escapeHtml(k.nodeAddress)+"&nbsp;-&nbsp;"}var o=f("<pre></pre>").css({"white-space":"pre-wrap"}).text(k.message);var n=f("<div>"+g.escapeHtml(k.timestamp)+"&nbsp;"+p+"&nbsp;<b>"+g.escapeHtml(k.level)+"</b>&nbsp;</div>").append(o);i.push(n)}});return i},getFormattedServiceApis:function(j){var i=[];f.each(j,function(m,n){var k=g.formatType({type:n.type,bundle:n.bundle});var l=g.formatBundle(n.bundle);i.push(f("<div></div>").text(k+" from "+l))});return i},getFormattedGarbageCollections:function(j){j.sort(function(l,k){return k.collectionCount-l.collectionCount});var i=[];f.each(j,function(m,k){var l=f('<span style="font-weight: bold;"></span>').text(k.name);var n=f("<span></span>").text(" - "+k.collectionCount+" times ("+k.collectionTime+")");var o=f("<div></div>").append(l).append(n);i.push(o)});return i},isGlobalPolicy:function(i){return g.getPolicyTypeListing(i)!==null},getPolicyTypeListing:function(i){return a.find(function(j){return i===j.value})},getComponentName:function(i){return i.permissions.canRead===true?i.component.name:i.id},getComboOptionText:function(i,k){var j=i.find(function(l){return l.value===k});return g.isDefinedAndNotNull(j)?j.text:undefined},throttle:function(i,j){return c.throttle(i,j)},getKeyValue:function(j,i){return i.split(".").reduce(function(l,k){return(typeof l===undefined||l===null)?l:(typeof l[k]=="function")?l[k]():l[k]},j)}};return g}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common"],function(d,c,e){return(nf.ErrorHandler=b(d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common)}}}(this,function(c,b,d){var a={handleAjaxError:function(h,e,f){if(e==="canceled"){if(c("#splash").is(":visible")){c("#message-title").text("Session Expired");c("#message-content").text("Your session has expired. Please reload to log in again.");c("#message-pane").show()}else{b.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="../nifi/"}})}return}if(c("#splash").is(":visible")){if(h.status===401){c("#message-title").text("Unauthorized")}else{if(h.status===403){c("#message-title").text("Insufficient Permissions")}else{if(h.status===409){c("#message-title").text("Invalid State")}else{if(h.status===413){c("#message-title").text("Payload Too Large")}else{c("#message-title").text("An unexpected error has occurred")}}}}if(c.trim(h.responseText)===""){c("#message-content").text("Please check the logs.")}else{c("#message-content").text(h.responseText)}c("#message-pane").show();return}if(h.status===400||h.status===404||h.status===409||h.status==413||h.status===503){b.showOkDialog({headerText:"Error",dialogContent:d.escapeHtml(h.responseText)})}else{if(h.status===403){b.showOkDialog({headerText:"Insufficient Permissions",dialogContent:d.escapeHtml(h.responseText)})}else{if(h.status<99||h.status===12007||h.status===12029){var g="Please ensure the application is running and check the logs for any errors.";if(d.isDefinedAndNotNull(e)){if(e==="timeout"){g="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(e==="abort"){g="Request has been aborted."}else{if(e==="No Transport"){g="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}c("#message-title").text("Unable to communicate with NiFi");c("#message-content").text(g)}else{if(h.status===401){c("#message-title").text("Unauthorized");if(c.trim(h.responseText)===""){c("#message-content").text("Authentication is required to use this NiFi.")}else{c("#message-content").text(h.responseText)}}else{if(h.status===500){c("#message-title").text("An unexpected error has occurred");if(c.trim(h.responseText)===""){c("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{c("#message-content").text(h.responseText)}}else{if(h.status===200||h.status===201){c("#message-title").text("Parse Error");if(c.trim(h.responseText)===""){c("#message-content").text("Unable to interpret response from NiFi.")}else{c("#message-content").text(h.responseText)}}else{c("#message-title").text(h.status+": Unexpected Response");c("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}c("#message-pane").show()}}},handleConfigurationUpdateAjaxError:function(h,e,f){if(h.status===400){var i=h.responseText.split("\n");var g;if(i.length===1){g=c("<span></span>").text(i[0])}else{g=d.formatUnorderedList(i)}b.showOkDialog({dialogContent:g,headerText:"Configuration Error"})}else{a.handleAjaxError(h,e,f)}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nf-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.AuthorizationStorage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.AuthorizationStorage")))}else{nf.AjaxSetup=b(a.$,a.nf.AuthorizationStorage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(e){var d=a.getRequestToken();if(d!==null){e.setRequestHeader("Request-Token",d)}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Storage","nf.Client"],function(g,h,c,f,e,d){return(nf.CustomUi=b(g,h,c,f,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Storage,a.nf.Client)}}}(this,function(e,f,a,d,c,b){return{showCustomUi:function(g,i,h){return e.Deferred(function(j){e("#shell-close-button");var k=b.getRevision(g);var l={id:g.id,revision:k.version,clientId:k.clientId,editable:h,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};a.showPage(".."+i+"?"+e.param(l),false).done(function(){j.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(e){var d=false;var c=false;var f=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return e.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(g){var h=g;var i=h.clusterSummary;if(d===true){if(f!==i.connectedToCluster){b=true}}else{if(i.clustered&&!i.connectedToCluster){b=true}}c=i.clustered;f=i.connectedToCluster;d=true})},isClustered:function(){return c===true},isConnectedToCluster:function(){return f===true},didConnectedStateChange:function(){var g=b;b=false;return g}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary","nf.CanvasUtils"],function(g,h,j,f,i,e,c,d){return(nf.ProcessorDetails=b(g,h,j,f,i,e,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(e,b,f,d,g,h,i,c){var a;var j=function(n){var k=e('<div class="relationship-name ellipsis"></div>').text(n.name);if(n.autoTerminate===true){k.css("font-weight","bold")}var m=e('<div class="processor-relationship-container"></div>').append(k).appendTo("#read-only-auto-terminate-relationship-names");if(!b.isBlank(n.description)){var l=e('<div class="relationship-description"></div>').text(n.description);m.append(l)}return m};return{init:function(k){a=k;e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){f.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}var l=e("#read-only-auto-terminate-relationship-names");if(l.is(":visible")&&l.get(0).scrollHeight>Math.round(l.innerHeight())){l.css("border-width","1px")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-terminate-relationship-names").css("border-width","0").empty();e("#read-only-processor-properties").propertytable("clear");b.clearField("read-only-processor-id");b.clearField("read-only-processor-type");b.clearField("read-only-processor-name");b.clearField("read-only-concurrently-schedulable-tasks");b.clearField("read-only-scheduling-period");b.clearField("read-only-penalty-duration");b.clearField("read-only-yield-duration");b.clearField("read-only-run-duration");b.clearField("read-only-bulletin-level");b.clearField("read-only-execution-node");b.clearField("read-only-execution-status");b.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory");if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("disconnect")}},open:function(){b.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar()}e("#read-only-processor-properties").propertytable(Object.assign({supportsGoTo:a.supportsGoTo,readOnly:true},c&&{getParameterContext:function(l){return c.getParameterContext()}}))},showDetails:function(m,n){var l=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(n),dataType:"json"}).done(function(p){if(b.isDefinedAndNotNull(p.component)){var q=p.component;e("#processor-details").data("processorDetails",q);b.populateField("read-only-processor-id",q.id);b.populateField("read-only-processor-type",b.formatType(q));b.populateField("read-only-processor-bundle",b.formatBundle(q.bundle));b.populateField("read-only-processor-name",q.name);b.populateField("read-only-concurrently-schedulable-tasks",q.config.concurrentlySchedulableTaskCount);b.populateField("read-only-scheduling-period",q.config.schedulingPeriod);b.populateField("read-only-penalty-duration",q.config.penaltyDuration);b.populateField("read-only-yield-duration",q.config.yieldDuration);b.populateField("read-only-run-duration",b.formatDuration(q.config.runDurationMillis));b.populateField("read-only-bulletin-level",q.config.bulletinLevel);b.populateField("read-only-processor-comments",q.config.comments);var o=true;var s=q.config.schedulingStrategy;if(s==="EVENT_DRIVEN"){o=false;s="Event driven"}else{if(s==="CRON_DRIVEN"){s="CRON driven"}else{if(s==="TIMER_DRIVEN"){s="Timer driven"}else{s="On primary node"}}}b.populateField("read-only-scheduling-strategy",s);if(o===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var r=q.config.executionNode;if(r==="ALL"){r="All nodes"}else{if(r==="PRIMARY"){r="Primary node only"}}b.populateField("read-only-execution-node",r);e("#read-only-execution-node-options").show();if(!b.isEmpty(q.relationships)){e.each(q.relationships,function(t,u){j(u)})}else{e("#read-only-auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}}});var k=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(n),dataType:"json"}).done(function(o){var p=o.componentHistory;e("#processor-details").data("processorHistory",p)});e.when(l,k).done(function(t,x){var u=t[0];var p=u.component;var w=x[0];var r=w.componentHistory;var v;e("#read-only-processor-properties").propertytable("setGroupId",p.parentGroupId).propertytable("loadProperties",p.config.properties,p.config.descriptors,r.propertyHistory);var s=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&b.isDefinedAndNotNull(h)&&b.isDefinedAndNotNull(p.config.customUiUrl)&&p.config.customUiUrl!==""){s.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");h.showCustomUi(u,p.config.customUiUrl,false)}}})}if(a.supportsStatusBar&&b.isDefinedAndNotNull(a.nfCanvasUtils)){e("#processor-details-status-bar").statusbar("observe",p.id);v=a.nfCanvasUtils.getSelectionById(p.id);if(b.isDefinedAndNotNull(a.nfActions)&&a.nfCanvasUtils.isProcessor(v)&&a.nfCanvasUtils.canModify(v)){var q=function(){var y=e("#processor-details-tabs").find(".selected-tab").text();e("#processor-configuration-tabs").find('.tab:contains("'+y+'")').trigger("click");e("#processor-details").modal("hide");e("#processor-details-status-bar").statusbar("showButtons")};e("#processor-details-status-bar").statusbar("buttons",[{buttonHtml:'<i class="fa fa-stop stop-configure-icon" aria-hidden="true"></i><span>Stop & Configure</span>',clazz:"button button-icon auto-width",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return !a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.stopAndConfigure(v,q)}}},{buttonText:"Configure",clazz:"fa fa-cog button-icon",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.showConfiguration(v,q)}}}])}}e("#processor-details").modal("setButtonModel",s).modal("show");e("#processor-details div.relationship-name").ellipsis();var o=e("#read-only-auto-terminate-relationship-names");if(o.is(":visible")&&o.get(0).scrollHeight>Math.round(o.innerHeight())){o.css("border-width","1px")}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Storage","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.FilteredDialogCommon","nf.ReportingTask","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement"],function(j,f,q,r,i,k,g,h,d,m,l,n,e,p,c,o){return(nf.Settings=b(j,f,q,r,i,k,g,h,d,m,l,n,e,p,c,o))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.ReportingTask"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.ReportingTask,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement)}}}(this,function(A,a,O,i,k,s,M,T,H,d,R,B,K,e,t,w){var F={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks",registries:"../nifi-api/controller/registry-clients"}};var z={autosizeColsMode:a.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var r=function(){return A("#controller-services-table")};var Q=function(Y){var X=[];if(M.isDefinedAndNotNull(Y.maxTimerDrivenThreadCount)&&!A.isNumeric(Y.maxTimerDrivenThreadCount)){X.push("Maximum Timer Driven Thread Count must be an integer value")}if(M.isDefinedAndNotNull(Y.maxEventDrivenThreadCount)&&!A.isNumeric(Y.maxEventDrivenThreadCount)){X.push("Maximum Event Driven Thread Count must be an integer value")}if(X.length>0){k.showOkDialog({dialogContent:M.formatUnorderedList(X),headerText:"Configuration Error"});return false}else{return true}};var m=function(X){var Z=S();if(Q(Z)){var Y={revision:i.getRevision({revision:{version:X}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:Z};A.ajax({type:"PUT",url:F.urls.controllerConfig,data:JSON.stringify(Y),dataType:"json",contentType:"application/json"}).done(function(aa){k.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});A("#settings-save").off("click").on("click",function(){m(aa.revision.version)})}).fail(d.handleConfigurationUpdateAjaxError)}};var j=function(){};var S=function(){var X={};X.maxTimerDrivenThreadCount=A("#maximum-timer-driven-thread-count-field").val();X.maxEventDrivenThreadCount=A("#maximum-event-driven-thread-count-field").val();return X};var W=function(Z,Y){if(Y.searchString===""){return true}try{var ac=new RegExp(Y.searchString,"i")}catch(ab){return false}var aa=Z.label.search(ac)>=0;var X=Z.tags.search(ac)>=0;return aa||X};var o=function(Z,X){var Y=[];A.each(Z,function(ac,ad){Y.push(ad)});var aa=X.toLowerCase();var ab=true;A.each(Y,function(ac,ad){if(aa.indexOf(ad)===-1){ab=false;return false}});return ab};var n=function(X){return X.restricted===false||M.canAccessComponentRestrictions(X.explicitRestrictions)};var v=function(ab,Y,aa,Z,X){if(!X.permissions.canRead){return'<span class="blank">'+M.escapeHtml(X.id)+"</span>"}return M.escapeHtml(X.component.name)};var U=function(X,Z){var Y=function(ah,ag){if(ah.permissions.canRead&&ag.permissions.canRead){if(X.columnId==="moreDetails"){var ad=0;if(!M.isEmpty(ah.bulletins)){ad=ah.bulletins.length}var aa=0;if(!M.isEmpty(ag.bulletins)){aa=ag.bulletins.length}return ad-aa}else{if(X.columnId==="type"){var ae=M.isDefinedAndNotNull(ah.component[X.columnId])?M.substringAfterLast(ah.component[X.columnId],"."):"";var ac=M.isDefinedAndNotNull(ag.component[X.columnId])?M.substringAfterLast(ag.component[X.columnId],"."):"";return ae===ac?0:ae>ac?1:-1}else{if(X.columnId==="state"){var af;if(ah.component.validationStatus==="VALIDATING"){af="Validating"}else{if(ah.component.validationStatus==="INVALID"){af="Invalid"}else{af=M.isDefinedAndNotNull(ah.component[X.columnId])?ah.component[X.columnId]:""}}var aj;if(ag.component.validationStatus==="VALIDATING"){aj="Validating"}else{if(ag.component.validationStatus==="INVALID"){aj="Invalid"}else{aj=M.isDefinedAndNotNull(ag.component[X.columnId])?ag.component[X.columnId]:""}}return af===aj?0:af>aj?1:-1}else{var ab=M.isDefinedAndNotNull(ah.component[X.columnId])?ah.component[X.columnId]:"";var ai=M.isDefinedAndNotNull(ag.component[X.columnId])?ag.component[X.columnId]:"";return ab===ai?0:ab>ai?1:-1}}}}else{if(!ah.permissions.canRead&&!ag.permissions.canRead){return 0}if(ah.permissions.canRead){return 1}else{return -1}}};Z.sort(Y,X.sortAsc)};var C=function(){return A("#reporting-task-type-filter").val()};var p=function(){var Y=A("#reporting-task-types-table").data("gridInstance");if(M.isDefinedAndNotNull(Y)){var X=Y.getData();X.setFilterArgs({searchString:C()});X.refresh();A("#new-reporting-task-dialog").modal("refreshButtons");if(X.getLength()>0){R.choseFirstRow(Y)}}};var P=function(){A("#reporting-task-type-description").attr("title","").text("");A("#reporting-task-type-name").attr("title","").text("");A("#reporting-task-type-bundle").attr("title","").text("");A("#selected-reporting-task-name").text("");A("#selected-reporting-task-type").text("").removeData("bundle");A("#reporting-task-description-container").hide()};var h=function(){P();var X=A("#reporting-task-types-table").data("gridInstance");X.resetActiveCell()};var I=function(af,aa){var ad=W(af,aa);var Z=true;if(ad){var ae=A("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var ac=ae.length>0;if(ac){Z=o(ae,af.tags)}}var ab=true;if(ad&&Z){var X=A("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(M.isDefinedAndNotNull(X)&&X.value!==""){ab=(af.bundle.group===X.value)}}var Y=ad&&Z&&ab;if(Y===false&&A("#selected-reporting-task-type").text()===af.type){h()}return Y};var L=function(){var Y=A("#selected-reporting-task-type").text();var X=A("#selected-reporting-task-type").data("bundle");if(Y===""){k.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{l(Y,X)}};var l=function(X,Z){var aa={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:X,bundle:Z}};var Y=A.ajax({type:"POST",url:F.urls.createReportingTask,data:JSON.stringify(aa),dataType:"json",contentType:"application/json"}).done(function(ac){var ae=A("#reporting-tasks-table").data("gridInstance");var ab=ae.getData();ab.addItem(A.extend({type:"ReportingTask",bulletins:[]},ac));ab.reSort();ae.invalidate();var ad=ab.getRowById(ac.id);R.choseRow(ae,ad);ae.scrollRowIntoView(ad)}).fail(d.handleAjaxError);A("#new-reporting-task-dialog").modal("hide");return Y};var f=function(){var X={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{name:A("#registry-name").val(),uri:A("#registry-location").val(),description:A("#registry-description").val()}};var Y=A.ajax({type:"POST",url:F.urls.registries,data:JSON.stringify(X),dataType:"json",contentType:"application/json"}).done(function(ac){var Z=A("#registries-table").data("gridInstance");var aa=Z.getData();aa.addItem(A.extend({type:"Registry"},ac));aa.reSort();Z.invalidate();var ab=aa.getRowById(ac.id);R.choseRow(Z,ab);Z.scrollRowIntoView(ab);A("#registry-configuration-dialog").modal("hide")}).fail(d.handleConfigurationUpdateAjaxError);return Y};var y=function(ab){var Y=A("#registries-table").data("gridInstance");var Z=Y.getData();var ac=Z.getItemById(ab);var aa={revision:i.getRevision(ac),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{id:ab,name:A("#registry-name").val(),uri:A("#registry-location").val(),description:A("#registry-description").val()}};var X=A.ajax({type:"PUT",url:ac.uri,data:JSON.stringify(aa),dataType:"json",contentType:"application/json"}).done(function(ad){Z.updateItem(ab,A.extend({type:"Registry"},ad));A("#registry-configuration-dialog").modal("hide")}).fail(d.handleConfigurationUpdateAjaxError);return X};var g=function(){var Y=[{id:"type",name:"Type",field:"label",formatter:M.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:M.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:M.genericValueFormatter}];var X=new a.Data.DataView({inlineFilters:false});X.setItems([]);X.setFilterArgs({searchString:C()});X.setFilter(I);M.sortType({columnId:"type",sortAsc:true},X);var ab=new a.Grid("#reporting-task-types-table",X,Y,z);ab.setSelectionModel(new a.RowSelectionModel());ab.registerPlugin(new a.AutoTooltips());ab.setSortColumn("type",true);ab.onSort.subscribe(function(ad,ac){M.sortType({columnId:ac.sortCol.field,sortAsc:ac.sortAsc},X)});ab.onSelectedRowsChanged.subscribe(function(ah,ae){if(A.isArray(ae.rows)&&ae.rows.length===1){var ag=ae.rows[0];var ac=ab.getDataItem(ag);if(M.isDefinedAndNotNull(ac)){A("#reporting-task-description-container").show();if(M.isBlank(ac.description)){A("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{A("#reporting-task-type-description").width(A("#reporting-task-description-container").innerWidth()-1).html(ac.description).ellipsis()}var ad=M.formatBundle(ac.bundle);var af=M.formatType(ac);A("#reporting-task-type-name").text(af).attr("title",af);A("#reporting-task-type-bundle").text(ad).attr("title",ad);A("#selected-reporting-task-name").text(ac.label);A("#selected-reporting-task-type").text(ac.type).data("bundle",ac.bundle);A("#new-reporting-task-dialog").modal("refreshButtons")}}});ab.onDblClick.subscribe(function(ae,ad){var ac=ab.getDataItem(ad.row);if(n(ac)){l(ac.type,ac.bundle)}});ab.onViewportChanged.subscribe(function(ad,ac){M.cleanUpTooltips(A("#reporting-task-types-table"),"div.view-usage-restriction")});X.onRowCountChanged.subscribe(function(ad,ac){ab.updateRowCount();ab.render();A("#displayed-reporting-task-types").text(ac.current)});X.onRowsChanged.subscribe(function(ad,ac){ab.invalidateRows(ac.rows);ab.render()});X.syncGridSelection(ab,true);A("#reporting-task-types-table").data("gridInstance",ab).on("mouseenter","div.slick-cell",function(af){var ag=A(this).find("div.view-usage-restriction");if(ag.length&&!ag.data("qtip")){var ae=A(this).find("span.row-id").text();var ad=X.getItemById(ae);if(ad.restricted===true){var ah=A("<div></div>");if(M.isBlank(ad.usageRestriction)){ah.append(A('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{ah.append(A('<p style="margin-bottom: 3px;"></p>').text(ad.usageRestriction+" Requires the following permissions:"))}var ac=[];if(M.isDefinedAndNotNull(ad.explicitRestrictions)){A.each(ad.explicitRestrictions,function(ai,ak){var aj=ak.requiredPermission;ac.push("'"+aj.label+"' - "+M.escapeHtml(ak.explanation))})}else{ac.push("Access to restricted components regardless of restrictions.")}ah.append(M.formatUnorderedList(ac));ag.qtip(A.extend({},M.config.tooltipConfig,{content:ah,position:{container:A("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var aa=M.getPolicyTypeListing("restricted-components");A.ajax({type:"GET",url:F.urls.reportingTaskTypes,dataType:"json"}).done(function(ad){var ai=0;var af=[];var ac=O.set();var ah=O.map();var ag=O.map();X.beginUpdate();A.each(ad.reportingTaskTypes,function(aj,ak){if(ak.restricted===true){if(M.isDefinedAndNotNull(ak.explicitRestrictions)){A.each(ak.explicitRestrictions,function(al,an){var am=an.requiredPermission;if(!ag.has(am.id)){ag.set(am.id,am.label)}if(!ah.has(am.id)){ah.set(am.id,[])}ah.get(am.id).push({type:M.formatType(ak),bundle:M.formatBundle(ak.bundle),explanation:M.escapeHtml(an.explanation)})})}else{if(!ag.has(aa.value)){ag.set(aa.value,aa.text)}if(!ah.has(aa.value)){ah.set(aa.value,[])}ah.get(aa.value).push({type:M.formatType(ak),bundle:M.formatBundle(ak.bundle),explanation:M.escapeHtml(ak.usageRestriction)})}}ac.add(ak.bundle.group);X.addItem({id:ai+++"",label:M.substringAfterLast(ak.type,"."),type:ak.type,bundle:ak.bundle,description:M.escapeHtml(ak.description),restricted:ak.restricted,usageRestriction:M.escapeHtml(ak.usageRestriction),explicitRestrictions:ak.explicitRestrictions,tags:ak.tags.join(", ")});A.each(ak.tags,function(am,al){af.push(al.toLowerCase())})});X.endUpdate();X.reSort();ab.invalidate();T.addComponentRestrictions(ah,ag);A("#total-reporting-task-types, #displayed-reporting-task-types").text(ad.reportingTaskTypes.length);A("#reporting-task-tag-cloud").tagcloud({tags:af,select:p,remove:p});var ae=[{text:"all groups",value:""}];ac.each(function(aj){ae.push({text:aj,value:aj})});A("#reporting-task-bundle-group-combo").combo({options:ae,select:p})}).fail(d.handleAjaxError);var Z=[A.ui.keyCode.UP,A.ui.keyCode.PAGE_UP,A.ui.keyCode.DOWN,A.ui.keyCode.PAGE_DOWN];A("#reporting-task-type-filter").off("keyup").on("keyup",function(af){var ae=af.keyCode?af.keyCode:af.which;if(A.inArray(ae,Z)!==-1){return}if(ae===A.ui.keyCode.ENTER){var ac=ab.getSelectedRows();if(ac.length>0){var ad=ab.getDataItem(ac[0]);if(n(ad)){L()}}}else{p()}});R.addKeydownListener("#reporting-task-type-filter",ab,ab.getData());A("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var ac=ab.getSelectedRows();if(ac.length>0){var ad=ab.getDataItem(ac[0]);return n(ad)===false}else{return ab.getData().getLength()===0}},handler:{click:function(){L()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}],handler:{close:function(){P();A("#reporting-task-type-filter").val("");A("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");A("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});p();var ac=A("#reporting-task-types-table").data("gridInstance");ac.setSelectedRows([]);ac.resetActiveCell()},resize:function(){A("#reporting-task-type-description").width(A("#reporting-task-description-container").innerWidth()-1).text(A("#reporting-task-type-description").attr("title")).ellipsis()}}});A("#registry-configuration-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){A("#registry-id").text("");A("#registry-name").val("");A("#registry-location").val("");A("#registry-description").val("")}}})};var c=function(){g();var ab=function(ak,ae,aj,ag,ad){if(!ad.permissions.canRead){return""}var af='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';af+='<div title="Usage" class="pointer reporting-task-usage fa fa-book"></div>';var ah=!M.isEmpty(ad.component.validationErrors);var ai=!M.isEmpty(ad.bulletins);if(ah){af+='<div class="pointer has-errors fa fa-warning" ></div>'}if(ai){af+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(ah||ai){af+='<span class="hidden row-id">'+M.escapeHtml(ad.component.id)+"</span>"}return af};var ac=function(al,ak,aj,af,ad){var ah="",ai="";if(ad.status.validationStatus==="VALIDATING"){ah="validating fa fa-spin fa-circle-notch";ai="Validating"}else{if(ad.status.validationStatus==="INVALID"){ah="invalid fa fa-warning";ai="Invalid"}else{if(ad.status.runStatus==="STOPPED"){ai="Stopped";ah="fa fa-stop stopped"}else{if(ad.status.runStatus==="RUNNING"){ai="Running";ah="fa fa-play running"}else{ai="Disabled";ah="icon icon-enable-false disabled"}}}}var ag="";if(M.isDefinedAndNotNull(ad.status.activeThreadCount)&&ad.status.activeThreadCount>0){ag="("+ad.status.activeThreadCount+")"}var ae='<div layout="row"><div class="'+ah+'"></div>';return ae+'<div class="status-text">'+M.escapeHtml(ai)+'</div><div style="float: left; margin-left: 4px;">'+M.escapeHtml(ag)+"</div></div>"};var aa=function(am,ak,ai,ah,ad){var al="";var ae=ad.permissions.canWrite;var ag=ad.permissions.canRead;var aj=ad.operatePermissions.canWrite||ae;var af=ad.status.runStatus==="STOPPED";if(ad.status.runStatus==="RUNNING"){if(aj){al+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop"></div>'}}else{if(af||ad.status.runStatus==="DISABLED"){if(ag&&ae){al+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil"></div>'}if(aj&&ad.status.runStatus==="STOPPED"&&ad.status.validationStatus==="VALID"){al+='<div title="Start" class="pointer start-reporting-task fa fa-play"></div>'}if(ag&&ae&&ad.component.multipleVersionsAvailable===true){al+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange"></div>'}if(ag&&ae&&M.canModifyController()){al+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash"></div>'}}}if(ag&&ae&&ad.component.persistsState===true){al+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks"></div>'}if(T.isManagedAuthorizer()&&M.canAccessTenants()){al+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return al};var X=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:ab,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:v},{id:"type",name:"Type",formatter:M.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:M.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:ac}];X.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aa,sortable:false,width:115,maxWidth:115});var Z=new a.Data.DataView({inlineFilters:false});Z.setItems([]);U({columnId:"name",sortAsc:true},Z);var Y=new a.Grid("#reporting-tasks-table",Z,X,z);Y.setSelectionModel(new a.RowSelectionModel());Y.registerPlugin(new a.AutoTooltips());Y.setSortColumn("name",true);Y.onSort.subscribe(function(ae,ad){U({columnId:ad.sortCol.id,sortAsc:ad.sortAsc},Z)});Y.onClick.subscribe(function(ah,ae){var ag=A(ah.target);var af=Z.getItem(ae.row);if(Y.getColumns()[ae.cell].id==="actions"){if(ag.hasClass("edit-reporting-task")){B.showConfiguration(af)}else{if(ag.hasClass("start-reporting-task")){B.start(af)}else{if(ag.hasClass("stop-reporting-task")){B.stop(af)}else{if(ag.hasClass("delete-reporting-task")){B.promptToDeleteReportingTask(af)}else{if(ag.hasClass("view-state-reporting-task")){var ad=af.status.runStatus==="STOPPED"&&af.status.activeThreadCount===0;e.showState(af,ad)}else{if(ag.hasClass("change-version-reporting-task")){t.promptForVersionChange(af)}else{if(ag.hasClass("edit-access-policies")){w.showReportingTaskPolicy(af);A("#shell-close-button").click()}}}}}}}}else{if(Y.getColumns()[ae.cell].id==="moreDetails"){if(ag.hasClass("view-reporting-task")){B.showDetails(af)}else{if(ag.hasClass("reporting-task-usage")){A("#shell-close-button").click();K.showPage("../nifi-docs/documentation?"+A.param({select:af.component.type,group:af.component.bundle.group,artifact:af.component.bundle.artifact,version:af.component.bundle.version})).done(function(){E.showSettings()})}}}}});Z.onRowCountChanged.subscribe(function(ae,ad){Y.updateRowCount();Y.render()});Z.onRowsChanged.subscribe(function(ae,ad){Y.invalidateRows(ad.rows);Y.render()});Z.syncGridSelection(Y,true);A("#reporting-tasks-table").data("gridInstance",Y).on("mouseenter","div.slick-cell",function(aj){var ah=A(this).find("div.has-errors");if(ah.length&&!ah.data("qtip")){var ad=A(this).find("span.row-id").text();var af=Z.getItemById(ad);var ag=M.formatUnorderedList(af.component.validationErrors);if(M.isDefinedAndNotNull(ag)){ah.qtip(A.extend({},M.config.tooltipConfig,{content:ag,position:{target:"mouse",viewport:A("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ae=A(this).find("div.has-bulletins");if(ae.length&&!ae.data("qtip")){var ad=A(this).find("span.row-id").text();var af=Z.getItemById(ad);var ai=M.getFormattedBulletins(af.bulletins);var ag=M.formatUnorderedList(ai);if(M.isDefinedAndNotNull(ag)){ae.qtip(A.extend({},M.config.tooltipConfig,{content:ag,position:{target:"mouse",viewport:A("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var u=function(){var ac=function(ah,ae,ag,af,ad){if(!ad.permissions.canRead){return'<span class="blank">'+M.escapeHtml(ad.id)+"</span>"}return M.escapeHtml(ad.component.uri)};var aa=function(ah,ae,ag,af,ad){if(!ad.permissions.canRead){return'<span class="blank">'+M.escapeHtml(ad.id)+"</span>"}return M.escapeHtml(ad.component.description)};var Y=function(ai,ae,ah,ag,ad){var af="";if(M.canModifyController()){af+='<div title="Edit" class="pointer edit-registry fa fa-pencil"></div>';af+='<div title="Remove" class="pointer remove-registry fa fa-trash"></div>'}return af};var ab=[{id:"name",name:"Name",field:"name",formatter:v,sortable:true,resizable:true},{id:"uri",name:"Location",field:"uri",formatter:ac,sortable:true,resizable:true},{id:"description",name:"Description",field:"description",formatter:aa,sortable:true,resizable:true}];ab.push({id:"actions",name:"&nbsp;",resizable:false,formatter:Y,sortable:false,width:90,maxWidth:90});var Z=new a.Data.DataView({inlineFilters:false});Z.setItems([]);U({columnId:"name",sortAsc:true},Z);var X=new a.Grid("#registries-table",Z,ab,z);X.setSelectionModel(new a.RowSelectionModel());X.registerPlugin(new a.AutoTooltips());X.setSortColumn("name",true);X.onSort.subscribe(function(ae,ad){U({columnId:ad.sortCol.id,sortAsc:ad.sortAsc},Z)});X.onClick.subscribe(function(af,ad){var ae=A(af.target);var ag=Z.getItem(ad.row);if(X.getColumns()[ad.cell].id==="actions"){if(ae.hasClass("edit-registry")){D(ag)}else{if(ae.hasClass("remove-registry")){q(ag)}}}else{if(X.getColumns()[ad.cell].id==="moreDetails"){}}});Z.onRowCountChanged.subscribe(function(ae,ad){X.updateRowCount();X.render()});Z.onRowsChanged.subscribe(function(ae,ad){X.invalidateRows(ad.rows);X.render()});Z.syncGridSelection(X,true);A("#registries-table").data("gridInstance",X)};var D=function(X){A("#registry-id").text(X.id);A("#registry-name").val(X.component.name);A("#registry-location").val(X.component.uri);A("#registry-description").val(X.component.description);A("#registry-configuration-dialog").modal("setHeaderText","Edit Registry Client").modal("setButtonModel",[{buttonText:"Update",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){y(X.id)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}]).modal("show")};var q=function(X){k.showYesNoDialog({headerText:"Delete Registry",dialogContent:"Delete registry '"+M.escapeHtml(X.component.name)+"'?",yesHandler:function(){b(X)}})};var b=function(Y){var X=i.getRevision(Y);A.ajax({type:"DELETE",url:Y.uri+"?"+A.param({version:X.version,clientId:X.clientId,disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(aa){var Z=A("#registries-table").data("gridInstance");var ab=Z.getData();ab.deleteItem(Y.id)}).fail(d.handleAjaxError)};var N=function(){var ad=function(){A("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized");A("#read-only-maximum-event-driven-thread-count-field").addClass("unset").text("Unauthorized")};var ab=function(ae){if(ae){A("#general-settings div.editable").show();A("#general-settings div.read-only").hide();A("#settings-save").show()}else{A("#general-settings div.editable").hide();A("#general-settings div.read-only").show();A("#settings-save").hide()}};var aa=A.Deferred(function(ae){A.ajax({type:"GET",url:F.urls.controllerConfig,dataType:"json"}).done(function(af){if(af.permissions.canWrite){A("#maximum-timer-driven-thread-count-field").removeClass("unset").val(af.component.maxTimerDrivenThreadCount);A("#maximum-event-driven-thread-count-field").removeClass("unset").val(af.component.maxEventDrivenThreadCount);ab(true);A("#settings-save").off("click").on("click",function(){m(af.revision.version)})}else{if(af.permissions.canRead){A("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(af.component.maxTimerDrivenThreadCount);A("#read-only-maximum-event-driven-thread-count-field").removeClass("unset").text(af.component.maxEventDrivenThreadCount)}else{ad()}ab(false)}ae.resolve()}).fail(function(ah,af,ag){if(ah.status===403){ad();ab(false);ae.resolve()}else{ae.reject(ah,af,ag)}})}).promise();var X=F.urls.api+"/flow/controller/controller-services";var Z=H.loadControllerServices(X,r());var ac=G();var Y=V();return A.when(aa,Z,ac).done(function(ag,af){var ae=af[0];A("#settings-last-refreshed").text(ae.currentTime)}).fail(d.handleAjaxError)};var G=function(){return A.ajax({type:"GET",url:F.urls.reportingTasks,dataType:"json"}).done(function(X){var ab=[];A.each(X.reportingTasks,function(ad,ac){ab.push(A.extend({type:"ReportingTask",bulletins:[]},ac))});var Z=A("#reporting-tasks-table");M.cleanUpTooltips(Z,"div.has-errors");M.cleanUpTooltips(Z,"div.has-bulletins");var Y=Z.data("gridInstance");var aa=Y.getData();aa.setItems(ab);aa.reSort();Y.invalidate()})};var V=function(){return A.ajax({type:"GET",url:F.urls.registries,dataType:"json"}).done(function(X){var Y=[];A.each(X.registries,function(ab,ac){Y.push(A.extend({type:"Registry"},ac))});var Z=A("#registries-table").data("gridInstance");var aa=Z.getData();aa.setItems(Y);aa.reSort();Z.invalidate()})};var x=function(){K.showContent("#settings").done(function(){J()});A("#settings-tabs").find(".selected-tab").click();E.resetTableSize()};var J=function(){A("#settings-save").mouseout()};var E={init:function(){A("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Reporting Task Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"},{name:"Registry Clients",tabContentId:"registries-tab-content"}],select:function(){var X=A(this).text();if(X==="General"){A("#controller-cs-availability").hide();A("#new-service-or-task").hide();A("#settings-save").show()}else{var Y=false;if(M.isDefinedAndNotNull(M.currentUser)){Y=M.currentUser.controllerPermissions.canWrite===true}if(Y){A("#new-service-or-task").show();A("div.controller-settings-table").css("top","32px");A("#new-service-or-task").attr("title",function(){if(X==="Reporting Task Controller Services"){A("#settings-save").hide();return"Create a new reporting task controller service"}else{if(X==="Reporting Tasks"){A("#settings-save").hide();return"Create a new reporting task"}else{if(X==="Registry Clients"){A("#settings-save").hide();return"Register a new registry client"}}}})}else{A("#new-service-or-task").hide();A("div.controller-settings-table").css("top","0")}if(X==="Reporting Task Controller Services"){A("#controller-cs-availability").show()}else{if(X==="Reporting Tasks"||X==="Registry Clients"){A("#controller-cs-availability").hide()}}E.resetTableSize()}}});A("#settings-refresh-button").click(function(){N()});A("#new-service-or-task").on("click",function(){var Z=A("#settings-tabs li.selected-tab").text();if(Z==="Reporting Task Controller Services"){var Y=F.urls.api+"/controller/controller-services";H.promptNewControllerService(Y,r())}else{if(Z==="Reporting Tasks"){A("#new-reporting-task-dialog").modal("show");var aa=A("#reporting-task-types-table").data("gridInstance");if(M.isDefinedAndNotNull(aa)){var X=aa.getData();aa.resizeCanvas();if(X.getLength()>0){R.choseFirstRow(aa)}}A("#reporting-task-type-filter").focus()}else{if(Z==="Registry Clients"){A("#registry-configuration-dialog").modal("setHeaderText","Add Registry Client").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){A(this).modal("hide")}}}]).modal("show");A("#registry-name").focus()}}}});j();H.init(r(),E.showSettings);c();u()},resetTableSize:function(){H.resetTableSize(r());var X=A("#reporting-tasks-table").data("gridInstance");if(M.isDefinedAndNotNull(X)){X.resizeCanvas()}},showSettings:function(){return N().done(x)},loadSettings:function(){return N()},selectControllerService:function(X){var Y=r().data("gridInstance");var Z=Y.getData();var aa=Z.getRowById(X);R.choseRow(Y,aa);Y.scrollRowIntoView(aa);A("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(X){var aa=A("#reporting-tasks-table").data("gridInstance");var Y=aa.getData();var Z=Y.getRowById(X);R.choseRow(aa,Z);aa.scrollRowIntoView(Z);A("#settings-tabs").find("li:eq(2)").click()},setBulletins:function(Z,X){if(A("#controller-services-table").data("gridInstance")){H.setBulletins(r(),Z)}var Y=A("#reporting-tasks-table").data("gridInstance");var ab=Y.getData();ab.beginUpdate();if(!M.isEmpty(X)){var ac=O.nest().key(function(ad){return ad.sourceId}).map(X,O.map);ac.each(function(ad,ae){var af=ab.getItemById(ae);if(M.isDefinedAndNotNull(af)){ab.updateItem(ae,A.extend(af,{bulletins:ad}))}})}else{var aa=ab.getItems();A.each(aa,function(ad,ae){ab.updateItem(ae.id,A.extend(ae,{bulletins:[]}))})}ab.endUpdate()}};return E}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,k,j,f,g,i,l,c,d,e){return(nf.ProcessGroupConfiguration=b(h,k,j,f,g,i,l,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(e,t,g,i,k,f,u,h,r,o){var d;var m;var b;var s={urls:{api:"../nifi-api",parameterContexts:"../nifi-api/flow/parameter-contexts"}};var l=function(){};var c=function(){return e("#process-group-controller-services-table")};var a=function(v,x){var w={revision:u.getRevision({revision:{version:v}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:x,name:e("#process-group-name").val(),comments:e("#process-group-comments").val(),parameterContext:{id:e("#process-group-parameter-context-combo").combo("getSelectedOption").value},flowfileConcurrency:e("#process-group-flowfile-concurrency-combo").combo("getSelectedOption").value,flowfileOutboundPolicy:e("#process-group-outbound-policy-combo").combo("getSelectedOption").value,defaultFlowFileExpiration:e("#process-group-default-flowfile-expiration").val(),defaultBackPressureObjectThreshold:e("#process-group-default-back-pressure-object-threshold").val(),defaultBackPressureDataSizeThreshold:e("#process-group-default-back-pressure-data-size-threshold").val()}};e.ajax({type:"PUT",data:JSON.stringify(w),url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json",contentType:"application/json"}).done(function(z){if(z.permissions.canRead&&z.component.parentGroupId===o.getGroupId()){h.set(z)}k.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});e("#process-group-configuration-save").off("click").on("click",function(){a(z.revision.version,x)});var y=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";e.ajax({type:"GET",url:y,dataType:"json"}).done(function(A){var C=c();i.cleanUpTooltips(C,"div.has-errors");var B=C.data("gridInstance");var D=B.getData();e.each(A.controllerServices,function(F,E){D.updateItem(E.id,E)})});o.reload()}).fail(g.handleConfigurationUpdateAjaxError)};var n=function(x){var A=function(){e("#read-only-process-group-name").text("Unauthorized");e("#read-only-process-group-comments").text("Unauthorized");e("#read-only-process-group-default-flowfile-expiration").text("Unauthorized");e("#read-only-process-group-default-back-pressure-object-threshold").text("Unauthorized");e("#read-only-process-group-default-back-pressure-data-size-threshold").text("Unauthorized")};var z=function(C){if(C){e("#process-group-configuration div.editable").show();e("#process-group-configuration div.read-only").hide();e("#process-group-configuration-save").show()}else{e("#process-group-configuration div.editable").hide();e("#process-group-configuration div.read-only").show();e("#process-group-configuration-save").hide()}};e("#process-group-id").text(x);e("#process-group-configuration-refresh-button").off("click").on("click",function(){n(x)});e("#add-process-group-configuration-controller-service").off("click").on("click",function(){var D=e("#process-group-configuration-tabs li.selected-tab").text();if(D==="Controller Services"){var C=s.urls.api+"/process-groups/"+encodeURIComponent(x)+"/controller-services";d.promptNewControllerService(C,c())}});var y=e.Deferred(function(C){e.ajax({type:"GET",url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json"}).done(function(D){e("#process-group-configuration").data("process-group",D);var F=D.component;if(D.permissions.canWrite){e("#process-group-name").removeClass("unset").val(F.name);e("#process-group-comments").removeClass("unset").val(F.comments);e("#process-group-flowfile-concurrency-combo").removeClass("unset").combo({options:[{text:"Single FlowFile Per Node",value:"SINGLE_FLOWFILE_PER_NODE",description:"Only a single FlowFile is to be allowed to enter the Process Group at a time on each node in the cluster. While that FlowFile may be split into many or spawn many children, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the previous FlowFile - and all of its child/descendent FlowFiles - have been processed."},{text:"Single Batch Per Node",value:"SINGLE_BATCH_PER_NODE",description:"When an Input Port pulls a FlowFile into the Process Group, FlowFiles will continue to be ingested into the Process Group until all input queues have been emptied. At that point, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the entire batch of FlowFiles has been processed."},{text:"Unbounded",value:"UNBOUNDED",description:"The number of FlowFiles that can be processed concurrently is unbounded."}],selectedOption:{value:F.flowfileConcurrency}});e("#process-group-outbound-policy-combo").removeClass("unset").combo({options:[{text:"Stream When Available",value:"STREAM_WHEN_AVAILABLE",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will be transferred out of the Process Group as soon as they are available."},{text:"Batch Output",value:"BATCH_OUTPUT",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will remain queued until all FlowFiles in the Process Group are ready to be transferred out of the group. The FlowFiles will then be transferred out of the group. This setting will be ignored if the FlowFile Concurrency is Unbounded."}],selectedOption:{value:F.flowfileOutboundPolicy}});e("#process-group-default-flowfile-expiration").removeClass("unset").val(F.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").removeClass("unset").val(F.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").removeClass("unset").val(F.defaultBackPressureDataSizeThreshold);e("#process-group-configuration-header-text").text(F.name+" Configuration");z(true);e("#process-group-configuration-save").off("click").on("click",function(){a(D.revision.version,D.id)})}else{if(D.permissions.canRead){e("#read-only-process-group-name").text(F.name);e("#read-only-process-group-comments").text(F.comments);var G;if(F.flowfileConcurrency=="UNBOUNDED"){G="Unbounded"}else{if(F.flowfileConcurrency=="SINGLE_FLOWFILE_PER_NODE"){G="Single FlowFile Per Node"}else{if(F.flowfileConcurrency=="SINGLE_BATCH_PER_NODE"){G="Single Batch Per Node"}else{G="Unknown"}}}e("#read-only-process-group-flowfile-concurrency").text(G);var E=F.flowfileOutboundPolicy=="BATCH_OUTPUT"?"Batch Output":"Stream When Available";e("#read-only-process-group-outbound-policy").text(E);e("#process-group-configuration-header-text").text(F.name+" Configuration");e("#process-group-default-flowfile-expiration").text(F.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").text(F.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").text(F.defaultBackPressureDataSizeThreshold);e("#read-only-process-group-default-flowfile-expiration").text(F.defaultFlowFileExpiration);e("#read-only-process-group-default-back-pressure-object-threshold").text(F.defaultBackPressureObjectThreshold);e("#read-only-process-group-default-back-pressure-data-size-threshold").text(F.defaultBackPressureDataSizeThreshold)}else{A()}z(false)}C.resolve(D)}).fail(function(G,D,E){if(G.status===403){var F;if(x===o.getGroupId()){F={permissions:{canRead:false,canWrite:o.canWriteCurrentGroup()}}}else{F=h.get(x)}e("#process-group-configuration").data("process-group",F);A();z(false);C.resolve(F)}else{C.reject(G,D,E)}})}).promise();var v=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";var w=d.loadControllerServices(v,c());var B=e.ajax({type:"GET",url:s.urls.parameterContexts,dataType:"json"});return e.when(y,w,B).done(function(G,K,E){var M=K[0];var O=E[0];e("#process-group-configuration-last-refreshed").text(M.currentTime);var F=O.parameterContexts;var P=[{text:"No parameter context",value:null}];var D=F.filter(function(Q){return Q.permissions.canRead});var L=F.filter(function(Q){return !Q.permissions.canRead});var N=D.sort(function(R,Q){if(R.component.name<Q.component.name){return -1}if(R.component.name>Q.component.name){return 1}return 0});var J=L.sort(function(R,Q){if(R.id<Q.id){return -1}if(R.id>Q.id){return 1}return 0});var C=N.concat(J);C.forEach(function(R){var Q;if(R.permissions.canRead){Q={text:R.component.name,value:R.id,description:R.component.description}}else{Q={disabled:true,text:R.id,value:R.id}}P.push(Q)});var I={text:"Create new parameter context...",value:undefined,optionClass:"unset"};if(i.canModifyParameterContexts()){P.push(I)}var H={options:P,select:function(Q){var R=this;if(typeof Q.value==="undefined"){e("#parameter-context-dialog").modal("setHeaderText","Add Parameter Context").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(e("#parameter-context-name").val()!==""){return false}return true},handler:{click:function(){m.addParameterContext(function(T){P.pop();var S={text:T.component.name,value:T.component.id,description:T.component.description};P.push(S);if(i.canModifyParameterContexts()){P.push(I)}H.selectedOption={value:T.component.id};R.combo("destroy").combo(H)})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e(this).modal("hide")}}}]).modal("show");if(e("#parameter-context-dialog").hasClass("read-only")){e("#parameter-context-dialog").removeClass("read-only");e("#parameter-context-dialog").addClass("edit-mode")}if(!e("#parameter-context-id-setting").hasClass("hidden")){e("#parameter-context-id-setting").addClass("hidden")}e("#parameter-context-name").focus()}}};if(i.isDefinedAndNotNull(G.parameterContext)){H.selectedOption={value:G.parameterContext.id}}e("#process-group-parameter-context-combo").combo("destroy").combo(H)}).fail(g.handleAjaxError)};var p=function(){r.showContent("#process-group-configuration").done(function(){q()});e("#process-group-configuration-tabs").find(".selected-tab").click();j.resetTableSize()};var q=function(){e("#process-group-configuration").removeData("process-group");e("#process-group-configuration-save").mouseout();e("#process-group-id").text("");e("#process-group-name").val("");e("#process-group-comments").val("");e("#process-group-default-flowfile-expiration").val("");e("#process-group-default-back-pressure-object-threshold").val("");e("#process-group-default-back-pressure-data-size-threshold").val("");e("#process-group-configuration-header-text").text("Process Group Configuration")};var j={init:function(w,v){d=w;m=v;e("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var y=e("#process-group-configuration").data("process-group");var z=i.isDefinedAndNotNull(y)?y.permissions.canWrite:false;var x=e(this).text();if(x==="General"){e("#flow-cs-availability").hide();e("#add-process-group-configuration-controller-service").hide();if(z){e("#process-group-configuration-save").show()}else{e("#process-group-configuration-save").hide()}}else{e("#flow-cs-availability").show();e("#process-group-configuration-save").hide();if(z){e("#add-process-group-configuration-controller-service").show();e("#process-group-controller-services-tab-content").css("top","32px")}else{e("#add-process-group-configuration-controller-service").hide();e("#process-group-controller-services-tab-content").css("top","0")}j.resetTableSize()}}});l();d.init(c())},resetTableSize:function(){d.resetTableSize(c())},showConfiguration:function(v){return n(v).done(p)},loadConfiguration:function(v){return n(v)},selectControllerService:function(v){var w=c().data("gridInstance");var x=w.getData();var y=x.getRowById(v);w.setSelectedRows([y]);w.scrollRowIntoView(y);e("#process-group-configuration-tabs").find("li:eq(1)").click()}};return j}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-source-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-target-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group div.setting-name").text("Within Group");d("#read-only-connection-source-group-name").text("");d("#read-only-connection-remote-source-url").text("").hide();d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group div.setting-name").text("Within Group");d("#read-only-connection-target-group-name").text("");d("#read-only-connection-remote-target-url").text("").hide();d("#read-only-relationship-names").css("border-width","0").empty();b.clearField("read-only-flow-file-expiration");b.clearField("read-only-back-pressure-object-threshold");b.clearField("read-only-back-pressure-data-size-threshold");b.clearField("read-only-load-balance-strategy");b.clearField("read-only-load-balance-partition-attribute");b.clearField("read-only-load-balance-compression");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);b.populateField("read-only-load-balance-strategy",b.getComboOptionText(b.loadBalanceStrategyOptions,t.loadBalanceStrategy));b.populateField("read-only-load-balance-partition-attribute",t.loadBalancePartitionAttribute);b.populateField("read-only-load-balance-compression",b.getComboOptionText(b.loadBalanceCompressionOptions,t.loadBalanceCompression));if(t.loadBalanceStrategy==="PARTITION_BY_ATTRIBUTE"){d("#read-only-load-balance-partition-attribute-setting").show()}else{d("#read-only-load-balance-partition-attribute-setting").hide()}if(t.loadBalanceStrategy==="DO_NOT_LOAD_BALANCE"){d("#read-only-load-balance-compression-setting").hide()}else{d("#read-only-load-balance-compression-setting").show()}if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(e,y,i,t,g){var x={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label",node:"Node"},urls:{api:"../nifi-api"}};var w={DURATION:function(A){return i.formatDuration(A)},COUNT:function(A){if(A%1===0){return i.formatInteger(A)}else{return i.formatFloat(A)}},DATA_SIZE:function(A){return i.formatDataSize(A)},FRACTION:function(A){return i.formatFloat(A/1000000)}};var o=null;var c=null;var r=null;var d=null;var l=function(C,G,E,B,F){e("#status-history-last-refreshed").text(E.generated);var A={groupId:C,id:G,type:B,instances:[]};var D=E.fieldDescriptors;A.details=E.componentDetails;A.selectedDescriptor=i.isUndefined(F)?D[0]:F;if(i.isDefinedAndNotNull(E.aggregateSnapshots)&&E.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:E.aggregateSnapshots})}else{k();return}e.each(E.nodeSnapshots,function(I,H){if(i.isDefinedAndNotNull(H.statusSnapshots)&&H.statusSnapshots.length>1){A.instances.push({id:H.nodeId,label:H.address+":"+H.apiPort,snapshots:H.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,D)}else{k()}};var h=function(C){e("#status-history-last-refreshed").text(C.generated);var A={type:"Node",instances:[]};var B=C.fieldDescriptors;A.details=C.componentDetails;A.selectedDescriptor=B[0];if(i.isDefinedAndNotNull(C.aggregateSnapshots)&&C.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:C.aggregateSnapshots})}else{k();return}e.each(C.nodeSnapshots,function(E,D){if(i.isDefinedAndNotNull(D.statusSnapshots)&&D.statusSnapshots.length>1){A.instances.push({id:D.nodeId,label:D.address+":"+D.apiPort,snapshots:D.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,B)}else{k()}};var k=function(){t.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var s=function(A,B){if(d===null){d={}}e.each(A.instances,function(D,C){C.snapshots.forEach(function(G){var F=new Date();var E=F.getTimezoneOffset()*60*1000;G.timestamp=new Date(G.timestamp+E+o)})});n(B,A.selectedDescriptor)};var n=function(C,B){var A=[];e.each(C,function(D,E){A.push({text:E.label,value:E.field,description:i.escapeHtml(E.description)})});e("#status-history-metric-combo").combo({selectedOption:{value:B.field},options:A,select:function(E){var F=null;e.each(C,function(G,H){if(E.value===H.field){F=H;return false}});if(F!==null){if(r===null||r.field!==F.field){c=null}r=F;var D=e("#status-history-dialog").data("status-history");D.selectedDescriptor=F;e("#status-history-dialog").data("status-history",D);m()}}});e("#status-history-dialog").modal("show")};var a=function(){return e("#status-history-chart-container").parent().outerHeight()-e("#status-history-chart-control-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)};var z=function(){return e("body").height()-e("#status-history-chart-control-container").outerHeight()-e("#status-history-refresh-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)-parseInt(e(".dialog-content").css("top"))-parseInt(e(".dialog-content").css("bottom"))};var v=function(){return e("body").width()-e("#status-history-details").innerWidth()-parseInt(e("#status-history-dialog").css("left"),10)-parseInt(e(".dialog-content").css("left"))-parseInt(e(".dialog-content").css("right"))};var m=function(){var ai=e("#status-history-dialog");if(ai.is(":visible")){var ab=ai.data("status-history");var ah=ab.selectedDescriptor;e("#status-history-details").empty();var D=p("Status History");y.map(ab.details).each(function(ax,aw){j(D,aw,ax)});var F={top:15,right:20,bottom:25,left:75};var Y=y.scaleOrdinal(y.schemeCategory10);var C=[];e.each(ab.instances,function(ax,aw){C.push(aw.label)});Y.domain(C);var at=[];e.each(ab.instances,function(ax,aw){if(i.isUndefinedOrNull(d[aw.id])){d[aw.id]=true}at.push({id:aw.id,label:aw.label,values:e.map(aw.snapshots,function(ay){return{timestamp:ay.timestamp,value:ay.statusMetrics[ah.field]}}),visible:d[aw.id]===true})});var P=function(aw){if(aw.getMilliseconds()){return y.timeFormat(":%S.%L")(aw)}else{if(aw.getSeconds()){return y.timeFormat(":%S")(aw)}else{if(aw.getMinutes()||aw.getHours()){return y.timeFormat("%H:%M")(aw)}else{if(aw.getDay()&&aw.getDate()!==1){return y.timeFormat("%a %d")(aw)}else{if(aw.getDate()!==1){return y.timeFormat("%b %d")(aw)}else{if(aw.getMonth()){return y.timeFormat("%B")(aw)}else{return y.timeFormat("%Y")(aw)}}}}}}};var O=e("#status-history-chart-container").empty();if(O.hasClass("ui-resizable")){O.resizable("destroy");O.removeAttr("style")}O.height(a());var A=O.outerWidth()-F.left-F.right;var B=O.outerHeight()-F.top-F.bottom;W=e("#status-history-container").width();if(A>W){A=W}an=z();if(B>an){B=an}var af=y.scaleTime().range([0,A]);var V=y.axisBottom(af).ticks(5).tickFormat(P);var ae=y.scaleLinear().range([B,0]);var G=y.axisLeft(ae).tickFormat(w[ah.formatter]);var H=y.line().curve(y.curveMonotoneX).x(function(aw){return af(aw.timestamp)}).y(function(aw){return ae(aw.value)});var N=y.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",O.parent().width()).attr("height",O.innerHeight());var I=N.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",A).attr("height",B);var av=N.append("g").attr("transform","translate("+F.left+", "+F.top+")");var E=y.min(at,function(aw){return y.min(aw.values,function(ax){return ax.timestamp})});var L=y.max(at,function(aw){return y.max(aw.values,function(ax){return ax.timestamp})});j(D,"Start",i.formatDateTime(E));j(D,"End",i.formatDateTime(L));af.domain([E,L]);ae.domain([q(at),u(at)]);av.append("g").attr("class","x axis").attr("transform","translate(0, "+B+")").call(V);av.append("g").attr("class","y axis").call(G).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ah.label);var ac=av.selectAll(".status").data(at).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ac.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return H(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return aw.visible===false}).append("title").text(function(aw){return aw.label});ac.each(function(aw){var ax=y.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+aw.id}).classed("hidden",function(ay){return ay.visible===false});ax.selectAll("circle.mark").data(aw.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("fill",function(){return Y(aw.label)}).attr("r",1.5).append("title").text(function(ay){return aw.label+" -- "+w[ah.formatter](ay.value)})});N.attr("width",O.parent().width()).attr("height",O.innerHeight());I.attr("width",A).attr("height",B);av.select(".x.axis").attr("transform","translate(0, "+B+")");var U=e("#status-history-chart-control-container").empty();var S=U.innerHeight()-F.top-F.bottom;var al=y.scaleTime().range([0,A]);var K=y.axisBottom(al).ticks(5).tickFormat(P);var ap=y.scaleLinear().range([S,0]);var aj=y.axisLeft(ap).tickValues(ae.domain()).tickFormat(w[ah.formatter]);var R=y.line().curve(y.curveMonotoneX).x(function(aw){return al(aw.timestamp)}).y(function(aw){return ap(aw.value)});var ag=y.select("#status-history-chart-control-container").append("svg").attr("width",O.parent().width()).attr("height",S+F.top+F.bottom);var X=ag.append("g").attr("transform","translate("+F.left+", "+F.top+")");al.domain(af.domain());ap.domain(ae.domain());X.append("g").attr("class","x axis").attr("transform","translate(0, "+S+")").call(K);X.append("g").attr("class","y axis").call(aj);var au=X.selectAll(".status").data(at).enter().append("g").attr("class","status");au.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return R(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return d[aw.id]===false}).append("title").text(function(aw){return aw.label});var M=function(){var aB=e.map(at,function(aH){var aF=af.domain();var aG=ae.domain();var aI=e.extend({},aH);return e.extend(aI,{values:e.grep(aH.values,function(aJ){return aJ.timestamp.getTime()>=aF[0].getTime()&&aJ.timestamp.getTime()<=aF[1].getTime()&&aJ.value>=aG[0]&&aJ.value<=aG[1]})})});var aw=e.grep(aB,function(aF){return aF.id!==x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aA=aw.length===0?"NA":w[ah.formatter](q(aw));var az=aw.length===0?"NA":w[ah.formatter](f(aw));var ax=aw.length===0?"NA":w[ah.formatter](u(aw));e("#node-aggregate-statistics").text(aA+" / "+ax+" / "+az);var aD=e.grep(aB,function(aF){return aF.id===x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aE=aD.length===0?"NA":w[ah.formatter](q(aD));var aC=aD.length===0?"NA":w[ah.formatter](f(aD));var ay=aD.length===0?"NA":w[ah.formatter](u(aD));e("#cluster-aggregate-statistics").text(aE+" / "+ay+" / "+aC)};var ar=function(aw,ax){af.domain(aw);ae.domain(ax);ac.selectAll(".chart-line").attr("d",function(ay){return H(ay.values)});ac.selectAll("circle.mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("r",function(){return y.brushSelection(Q.node())===null?1.5:4});av.select(".x.axis").call(V);av.select(".y.axis").call(G)};var J=function(){c=y.brushSelection(Q.node());var ax,aw;if(c===null){var ay=e.grep(at,function(az){return az.visible});if(ay.length===0){aw=ap.domain()}else{aw=[y.min(ay,function(az){return y.min(az.values,function(aA){return aA.value})}),y.max(ay,function(az){return y.max(az.values,function(aA){return aA.value})})]}ax=al.domain()}else{ax=[c[0][0],c[1][0]].map(al.invert,al);aw=[c[1][1],c[0][1]].map(ap.invert,ap)}ar(ax,aw);M()};var am=y.brush().extent([[al.range()[0],ap.range()[1]],[al.range()[1],ap.range()[0]]]).on("brush",J);var Q=X.append("g").attr("class","brush").on("click",J).call(am);if(i.isDefinedAndNotNull(c)){am=am.move(Q,c)}X.select("rect.selection").attr("style","pointer-events: all;").on("dblclick",function(){if(c!==null){var aw=ap.range();am.move(Q,[[c[0][0],aw[1]],[c[1][0],aw[0]]])}});var ad=e.grep(at,function(aw){return aw.id!==x.nifiInstanceId}).sort(function(ax,aw){return ax.label<aw.label?-1:ax.label>aw.label?1:0});var aq=function(ax,aw){var az=e("<div></div>").addClass("legend-label nf-checkbox-label").css("color",Y(aw.label)).text(aw.label).ellipsis();var ay=e('<div class="nf-checkbox"></div>').on("click",function(){var aA=y.selectAll("path.chart-line-"+aw.id);var aC=y.select("g.mark-group-"+aw.id);var aB=aC.classed("hidden");aA.classed("hidden",function(){return !aB});aC.classed("hidden",function(){return !aB});aw.visible=aB;d[aw.id]=aw.visible;J()}).addClass(aw.visible?"checkbox-checked":"checkbox-unchecked");e('<div class="legend-entry"></div>').append(ay).append(az).on("mouseenter",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",true)}).on("mouseleave",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",false)}).appendTo(ax)};var aa=e.grep(at,function(aw){return aw.id===x.nifiInstanceId});var ak=p("NiFi");j(ak,"Min / Max / Mean","","cluster-aggregate-statistics");aq(ak,aa[0]);if(ad.length>0){var Z=p("Nodes");j(Z,"Min / Max / Mean","","node-aggregate-statistics");e.each(ad,function(ax,aw){aq(Z,aw)})}J();var W,an,T,ao;O.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},resize:function(ay,ax){ao=e("#status-history-dialog");var aw={};if(i.isDefinedAndNotNull(ao.data("nf-dialog"))){aw=ao.data("nf-dialog")}aw["min-width"]=(ao.width()/e(window).width())*100+"%";aw["min-height"]=(ao.height()/e(window).height())*100+"%";aw.responsive["fullscreen-width"]=ao.outerWidth()+"px";aw.responsive["fullscreen-height"]=ao.outerHeight()+"px";W=v();if(ax.helper.width()>W){ax.helper.width(W);aw.responsive["fullscreen-width"]=e(window).width()+"px";aw["min-width"]="100%"}an=z();if(ax.helper.height()>an){ax.helper.height(an);aw.responsive["fullscreen-height"]=e(window).height()+"px";aw["min-height"]="100%"}T=a();if(ax.helper.height()<T){ax.helper.height(T)}aw["min-width"]=(parseInt(aw["min-width"],10)>=100)?"100%":aw["min-width"];aw["min-height"]=(parseInt(aw["min-height"],10)>=100)?"100%":aw["min-height"];ao.data("nfDialog",aw);ao.css("min-width",(O.outerWidth()+e("#status-history-details").outerWidth()+40));ao.css("min-height",(O.outerHeight()+e("#status-history-refresh-container").outerHeight()+e("#status-history-chart-control-container").outerHeight()+e(".dialog-buttons").outerHeight()+e(".dialog-header").outerHeight()+40+5));ao.center()},stop:m})}};var q=function(A){return y.min(A,function(B){return y.min(B.values,function(C){return C.value})})};var u=function(A){return y.max(A,function(B){return y.max(B.values,function(C){return C.value})})};var f=function(B){var C=0;var A=y.sum(B,function(D){C+=D.values.length;return y.sum(D.values,function(E){return E.value})});return A/C};var p=function(B){var A=e('<div class="status-history-detail"></div>').appendTo("#status-history-details");e('<div class="detail-container-label"></div>').text(B).appendTo(A);return e("<div></div>").appendTo(A)};var j=function(B,D,E,F){var C=e('<div class="detail-item"></div>').appendTo(B);e('<div class="setting-name"></div>').text(D).appendTo(C);var A=e('<div class="setting-field"></div>').text(E).appendTo(C);if(i.isDefinedAndNotNull(F)){A.attr("id",F)}};var b={init:function(A){o=A;e("#status-history-refresh-button").click(function(){var B=e("#status-history-dialog").data("status-history");if(B!==null){if(B.type===x.type.processor){b.showProcessorChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.processGroup){b.showProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.remoteProcessGroup){b.showRemoteProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.node){b.showNodeChart()}else{b.showConnectionChart(B.groupId,B.id,B.selectedDescriptor)}}}}}});e("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){e("#status-history-dialog").removeData("status-history");e("#status-history-chart-container").empty();e("#status-history-chart-control-container").empty();e("#status-history-details").empty();c=null;r=null;d=null},open:m}});e(window).on("resize",function(B){if(B.target===window){m()}i.toggleScrollable(e("#status-history-details").get(0))})},showConnectionChart:function(A,B,C){e.ajax({type:"GET",url:x.urls.api+"/flow/connections/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(D){l(A,B,D.statusHistory,x.type.connection,C)}).fail(g.handleAjaxError)},showProcessorChart:function(A,C,B){e.ajax({type:"GET",url:x.urls.api+"/flow/processors/"+encodeURIComponent(C)+"/status/history",dataType:"json"}).done(function(D){l(A,C,D.statusHistory,x.type.processor,B)}).fail(g.handleAjaxError)},showNodeChart:function(){e.ajax({type:"GET",url:x.urls.api+"/controller/status/history",dataType:"json"}).done(function(A){h(A.statusHistory)}).fail(g.handleAjaxError)},showProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.processGroup,C)}).fail(g.handleAjaxError)},showRemoteProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.remoteProcessGroup,C)}).fail(g.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.ErrorHandler","nf.StatusHistory","nf.ProcessorDetails","nf.ConnectionDetails","nf.ng.Bridge","lodash-core"],function(e,c,d,h,i,g,k,f,j){return(nf.SummaryTable=b(e,c,d,h,i,g,k,f,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.SummaryTable=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.StatusHistory"),require("nf.ProcessorDetails"),require("nf.ConnectionDetails"),require("nf.ng.Bridge"),require("lodash-core")))}else{nf.SummaryTable=b(a.$,a.Slick,a.nf.Common,a.nf.ErrorHandler,a.nf.StatusHistory,a.nf.ProcessorDetails,a.nf.ConnectionDetails,a.nf.ng.Bridge,a._)}}}(this,function(e,x,i,h,c,q,p,G,E){var C={urls:{api:"../nifi-api",status:"../nifi-api/flow/process-groups/root/status",systemDiagnostics:"../nifi-api/system-diagnostics",flowConfig:"../nifi-api/flow/config"}};var y="&nbsp;&nbsp;|&nbsp;&nbsp;";var F=function(I,H){if(top!==window){if(i.isDefinedAndNotNull(parent.nf)&&i.isDefinedAndNotNull(parent.nf.CanvasUtils)&&i.isDefinedAndNotNull(parent.nf.Shell)){parent.nf.CanvasUtils.showComponent(I,H);parent.$("#shell-close-button").click()}}};var n=function(V,S,P,M,I){var R=E.get(I,"predictions.predictedMillisUntilBytesBackpressure",-1);var O=E.get(I,"predictions.predictedMillisUntilCountBackpressure",-1);var J=E.get(I,"percentUseCount",0);var N=E.get(I,"percentUseBytes",0);var U=[{label:"object",timeToBackPressure:O},{label:"size",timeToBackPressure:R},];var T=[{label:"object",percent:J},{label:"size",percent:N}];var Q=E.maxBy(T,"percent");if(Q.percent>=100){return"now ("+Q.label+")"}var H=U.filter(function(W){return W.timeToBackPressure>=0});if(E.isEmpty(H)){return"NA"}var K=E.minBy(H,"timeToBackPressure");var L=i.formatPredictedDuration(K.timeToBackPressure);return i.escapeHtml(L)+" ("+K.label+")"};var r={id:"backpressurePrediction",field:"backpressurePrediction",name:"Estimated Time to Back Pressure",sortable:true,defaultSortAsc:false,formatter:n,resize:true,toolTip:"Estimated Time to Back Pressure"};var u=function(av){e("#summary-filter").keyup(function(){D()});e("#summary-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Processors",tabContentId:"processor-summary-tab-content"},{name:"Input Ports",tabContentId:"input-port-summary-tab-content"},{name:"Output Ports",tabContentId:"output-port-summary-tab-content"},{name:"Remote Process Groups",tabContentId:"remote-process-group-summary-tab-content"},{name:"Connections",tabContentId:"connection-summary-tab-content"},{name:"Process Groups",tabContentId:"process-group-summary-tab-content"}],select:function(){var be=e(this).text();if(be==="Processors"){var bd=e("#processor-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bd)){bd.resizeCanvas();e("#displayed-items").text(i.formatInteger(bd.getData().getLength()));e("#total-items").text(i.formatInteger(bd.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by name",value:"name"},{text:"by type",value:"type"}],select:function(bj){D()}})}else{if(be==="Connections"){var bc=e("#connection-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bc)){bc.resizeCanvas();e("#displayed-items").text(i.formatInteger(bc.getData().getLength()));e("#total-items").text(i.formatInteger(bc.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by source",value:"sourceName"},{text:"by name",value:"name"},{text:"by destination",value:"destinationName"}],select:function(bj){D()}})}else{if(be==="Input Ports"){var bi=e("#input-port-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bi)){bi.resizeCanvas();e("#displayed-items").text(i.formatInteger(bi.getData().getLength()));e("#total-items").text(i.formatInteger(bi.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bj){D()}})}else{if(be==="Output Ports"){var bh=e("#output-port-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bh)){bh.resizeCanvas();e("#displayed-items").text(i.formatInteger(bh.getData().getLength()));e("#total-items").text(i.formatInteger(bh.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bj){D()}})}else{if(be==="Remote Process Groups"){var bg=e("#remote-process-group-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bg)){bg.resizeCanvas();e("#displayed-items").text(i.formatInteger(bg.getData().getLength()));e("#total-items").text(i.formatInteger(bg.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by name",value:"name"},{text:"by uri",value:"targetUri"}],select:function(bj){D()}})}else{var bf=e("#process-group-summary-table").data("gridInstance");if(i.isDefinedAndNotNull(bf)){bf.resizeCanvas();e("#displayed-items").text(i.formatInteger(bf.getData().getLength()));e("#total-items").text(i.formatInteger(bf.getData().getLength()))}e("#summary-filter-type").combo({options:[{text:"by name",value:"name"}],select:function(bj){D()}})}}}}}e("#summary-filter").val("");D()}});var aI=function(bh,bd,bg,bf,bc){var be='<div title="View Processor Details" class="pointer show-processor-details fa fa-info-circle"></div>';if(!i.isEmpty(bc.bulletins)){be+='<div class="has-bulletins fa fa-sticky-note-o"></div><span class="hidden row-id">'+i.escapeHtml(bc.id)+"</span>"}return be};var aB=function(bh,bd,bg,bf,bc){var be="";if(av&&bc.executionNode==="PRIMARY"){be+='<div class="is-primary-icon" title="This component is only scheduled to execute on the Primary Node">P</div>'}be+=i.escapeHtml(bg);return be};var aG=function(bg,bd,bf,be,bc){return i.escapeHtml(bc.read)+y+i.escapeHtml(bc.written)};var ae=function(bg,bd,bf,be,bc){return i.formatInteger(bc.tasks)+y+i.escapeHtml(bc.tasksDuration)};var H=function(bg,bd,bf,be,bc){return i.formatValue(bf)};var bb=function(bk,bi,bh,be,bc){var bf="";var bg="";if(bc.terminatedThreadCount>0){bf="("+bc.activeThreadCount+y+bc.terminatedThreadCount+")";bg="Threads: (Active / Terminated)"}else{if(bc.activeThreadCount>0){bf="("+bc.activeThreadCount+")";bg="Active Threads"}}var bd;switch(bh.toLowerCase()){case"running":bd="fa fa-play running";break;case"stopped":bd="fa fa-stop stopped";break;case"enabled":bd="fa fa-flash enabled";break;case"disabled":bd="icon icon-enable-false disabled";break;case"validating":bd="fa fa-spin fa-circle-notch validating";break;case"invalid":bd="fa fa-warning invalid";break;default:bd=""}var bj='<div layout="row"><div class="'+bd+'"></div><div class="status-text">'+i.escapeHtml(bh)+'</div><div style="float: left; margin-left: 4px;" title="'+bg+'">'+i.escapeHtml(bf)+"</div></div>";return bj};var a5={id:"name",field:"name",name:"Name",formatter:aB,sortable:true,resizable:true};var aW={id:"runStatus",field:"runStatus",name:"Run Status",formatter:bb,sortable:true};var ay={id:"input",field:"input",name:'<span class="input-title">In</span>&nbsp;(<span class="input-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:i.genericValueFormatter};var aF={id:"io",field:"io",name:'<span class="read-title">Read</span>'+y+'<span class="written-title">Write</span>&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Data size in the last 5 min",formatter:aG,sortable:true,defaultSortAsc:false,resizable:true};var a7={id:"output",field:"output",name:'<span class="output-title">Out</span>&nbsp;(<span class="output-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:i.genericValueFormatter};var aD={id:"tasks",field:"tasks",name:'<span class="tasks-title">Tasks</span>'+y+'<span class="time-title">Time</span>&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / duration in the last 5 min",formatter:ae,sortable:true,defaultSortAsc:false,resizable:true};var aH=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:aI,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"},a5,{id:"type",field:"type",name:"Type",sortable:true,resizable:true,formatter:i.genericValueFormatter},{id:"parentGroup",field:"parentProcessGroupName",name:"Process Group",sortable:true,resizable:true,formatter:i.genericValueFormatter,toolTip:"Parent Process Group name"},aW,ay,aF,a7,aD];var aZ=(top!==window);if(av||aZ||i.SUPPORTS_SVG){var a3=function(bh,bd,bg,bf,bc){var be="";if(aZ){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Processor in '+i.escapeHtml(bc.processGroupNamePath)+'"></div>'}if(i.SUPPORTS_SVG){be+='<div class="pointer show-processor-status-history fa fa-area-chart" title="View Status History"></div>'}if(av){be+='<div class="pointer show-cluster-processor-summary fa fa-cubes" title="View Processor Details"></div>'}return be};aH.push({id:"actions",name:"&nbsp;",formatter:a3,resizable:false,sortable:false,width:75,maxWidth:75})}var az={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aJ=new x.Data.DataView({inlineFilters:false});aJ.setItems([]);aJ.setFilterArgs({searchString:"",property:"name"});aJ.setFilter(l);A("processor-summary-table",{columnId:"name",sortAsc:true},aJ);var a8=new x.Grid("#processor-summary-table",aJ,aH,az);a8.setSelectionModel(new x.RowSelectionModel());a8.registerPlugin(new x.AutoTooltips());a8.setSortColumn("name",true);a8.onSort.subscribe(function(bd,bc){A("processor-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},aJ)});a8.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=aJ.getItem(bc.row);if(a8.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){F(bd.groupId,bd.id)}else{if(be.hasClass("show-processor-status-history")){c.showProcessorChart(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-processor-summary")){m(bd.groupId,bd.id);e("#summary-loading-container").hide();e("#cluster-processor-summary-dialog").modal("show");P.resizeCanvas()}}}}else{if(a8.getColumns()[bc.cell].id==="moreDetails"){if(be.hasClass("show-processor-details")){q.showDetails(bd.groupId,bd.id)}}}});aJ.onRowCountChanged.subscribe(function(bd,bc){a8.updateRowCount();a8.render();if(e("#processor-summary-table").is(":visible")){e("#displayed-items").text(i.formatInteger(bc.current))}});aJ.onRowsChanged.subscribe(function(bd,bc){a8.invalidateRows(bc.rows);a8.render()});e("#processor-summary-table").data("gridInstance",a8).on("mouseenter","div.slick-cell",function(bg){var bd=e(this).find("div.has-bulletins");if(bd.length&&!bd.data("qtip")){var bh=e(this).find("span.row-id").text();var bc=aJ.getItemById(bh);var bf=i.getFormattedBulletins(bc.bulletins);var be=i.formatUnorderedList(bf);if(i.isDefinedAndNotNull(be)){bd.qtip(e.extend({},i.config.tooltipConfig,{content:be,position:{container:e("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});e("#cluster-processor-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Processor Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-processor-id").text("");e("#cluster-processor-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-processor-refresh-button").click(function(){m(e("#cluster-processor-group-id").text(),e("#cluster-processor-id").text())});var O=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},aW,ay,aF,a7,aD];var a2={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aS=new x.Data.DataView({inlineFilters:false});aS.setItems([]);A("cluster-processor-summary-table",{columnId:"node",sortAsc:true},aS);var P=new x.Grid("#cluster-processor-summary-table",aS,O,a2);P.setSelectionModel(new x.RowSelectionModel());P.registerPlugin(new x.AutoTooltips());P.setSortColumn("node",true);P.onSort.subscribe(function(bd,bc){A("cluster-processor-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},aS)});aS.onRowCountChanged.subscribe(function(bd,bc){P.updateRowCount();P.render()});aS.onRowsChanged.subscribe(function(bd,bc){P.invalidateRows(bc.rows);P.render()});e("#cluster-processor-summary-table").data("gridInstance",P);var aP=function(bg,bd,bf,be,bc){return'<div class="pointer show-connection-details fa fa-info-circle" title="View Connection Details"></div>'};var a6=function(bc){return E.isNumber(bc)&&bc>=0?E.clamp(bc,0,100)+"%":"NA"};var W=function(bi,be,bh,bf,bd){var bc="NA";if(i.isDefinedAndNotNull(bd.percentUseCount)){bc=a6(bd.percentUseCount)}var bg="NA";if(i.isDefinedAndNotNull(bd.percentUseBytes)){bg=a6(bd.percentUseBytes)}return i.escapeHtml(bc)+y+i.escapeHtml(bg)};var aY={id:"queued",field:"queued",name:'<span class="queued-title">Queue</span>&nbsp;(<span class="queued-size-title">Size</span>)',sortable:true,defaultSortAsc:false,resize:true,formatter:i.genericValueFormatter};var V={id:"backpressure",field:"backpressure",name:'Threshold %: <span class="backpressure-object-title">Queue</span>&nbsp;&nbsp;|&nbsp;&nbsp;<span class="backpressure-data-size-title">Size</span>',sortable:true,defaultSortAsc:false,formatter:W,resize:true};var aw=[{id:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:aP,width:50,maxWidth:50},{id:"name",field:"name",name:"Name",sortable:true,resizable:true,formatter:H},aY,V,r,ay,{id:"sourceName",field:"sourceName",name:"From Source",sortable:true,resizable:true,formatter:i.genericValueFormatter},a7,{id:"destinationName",field:"destinationName",name:"To Destination",sortable:true,resizable:true,formatter:i.genericValueFormatter}];if(av||aZ||i.SUPPORTS_SVG){var K=function(bh,bd,bg,bf,bc){var be="";if(aZ){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Connection"></div>'}if(i.SUPPORTS_SVG){be+='<div class="pointer show-connection-status-history fa fa-area-chart" title="View Status History"></div>'}if(av){be+='<div class="pointer show-cluster-connection-summary fa fa-cubes" title="View Connection Details"></div>'}return be};aw.push({id:"actions",name:"&nbsp;",formatter:K,resizable:false,sortable:false,width:75,maxWidth:75})}var ac={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var an=new x.Data.DataView({inlineFilters:false});an.setItems([]);an.setFilterArgs({searchString:"",property:"sourceName"});an.setFilter(l);A("connection-summary-table",{columnId:"sourceName",sortAsc:true},an);var aM=new x.Grid("#connection-summary-table",an,aw,ac);aM.setSelectionModel(new x.RowSelectionModel());aM.registerPlugin(new x.AutoTooltips());aM.setSortColumn("sourceName",true);aM.onSort.subscribe(function(bd,bc){A("connection-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},an)});aM.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=an.getItem(bc.row);if(aM.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){F(bd.groupId,bd.id)}else{if(be.hasClass("show-connection-status-history")){c.showConnectionChart(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-connection-summary")){b(bd.groupId,bd.id);e("#summary-loading-container").hide();e("#cluster-connection-summary-dialog").modal("show");aj.resizeCanvas()}}}}else{if(aM.getColumns()[bc.cell].id==="moreDetails"){if(be.hasClass("show-connection-details")){p.showDetails(bd.groupId,bd.id)}}}});an.onRowCountChanged.subscribe(function(bd,bc){aM.updateRowCount();aM.render();if(e("#connection-summary-table").is(":visible")){e("#displayed-items").text(i.formatInteger(bc.current))}});an.onRowsChanged.subscribe(function(bd,bc){aM.invalidateRows(bc.rows);aM.render()});e("#connection-summary-table").data("gridInstance",aM);e("#cluster-connection-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Connection Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-connection-id").text("");e("#cluster-connection-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-connection-refresh-button").click(function(){b(e("#cluster-connection-group-id").text(),e("#cluster-connection-id").text())});var R=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},aY,V,r,ay,a7];var L={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var J=new x.Data.DataView({inlineFilters:false});J.setItems([]);A("cluster-connection-summary-table",{columnId:"node",sortAsc:true},J);var aj=new x.Grid("#cluster-connection-summary-table",J,R,L);aj.setSelectionModel(new x.RowSelectionModel());aj.registerPlugin(new x.AutoTooltips());aj.setSortColumn("node",true);aj.onSort.subscribe(function(bd,bc){A("cluster-connection-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},J)});J.onRowCountChanged.subscribe(function(bd,bc){aj.updateRowCount();aj.render()});J.onRowsChanged.subscribe(function(bd,bc){aj.invalidateRows(bc.rows);aj.render()});e("#cluster-connection-summary-table").data("gridInstance",aj);var U=function(bh,bd,bg,bf,bc){var be="";if(!i.isEmpty(bc.bulletins)){be+='<div class="has-bulletins fa fa-sticky-note-o" style="margin-left: 5px; float: left;"></div><span class="hidden row-id">'+i.escapeHtml(bc.id)+"</span>"}return be};var aN={id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:U,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"};var ag={id:"transferred",field:"transferred",name:'<span class="transferred-title">Transferred</span>&nbsp;(<span class="transferred-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size transferred to and from connections in the last 5 min",resizable:true,defaultSortAsc:false,sortable:true,formatter:i.genericValueFormatter};var ad={id:"sent",field:"sent",name:'<span class="sent-title">Sent</span>&nbsp;(<span class="sent-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:i.genericValueFormatter};var aK={id:"received",field:"received",name:'<span class="received-title">Received</span>&nbsp;(<span class="received-size-title">Size</span>)&nbsp;<span style="font-weight: normal; overflow: hidden;">5 min</span>',toolTip:"Count / data size in the last 5 min",sortable:true,defaultSortAsc:false,resizable:true,formatter:i.genericValueFormatter};var aX=function(bi,bd,bh,be,bc){var bg,bf;switch(bh){case"UP_TO_DATE":bg="fa fa-check up-to-date";bf="Up to date";break;case"LOCALLY_MODIFIED":bg="fa fa-asterisk locally-modified";bf="Locally modified";break;case"STALE":bg="fa fa-arrow-circle-up stale";bf="Stale";break;case"LOCALLY_MODIFIED_AND_STALE":bg="fa fa-exclamation-circle locally-modified-and-stale";bf="Locally modified and stale";break;case"SYNC_FAILURE":bg="fa fa-question sync-failure";bf="Sync failure";break;default:bg="";bf=""}return'<div layout="row"><div class="'+bg+'"></div><div class="status-text">'+bf+"</div></div>"};var S=[aN,{id:"name",field:"name",name:"Name",sortable:true,resizable:true,formatter:H},{id:"versionedFlowState",field:"versionedFlowState",name:"Version State",sortable:true,resizable:true,formatter:aX},ag,ay,aF,a7,ad,aK];if(av||aZ||i.SUPPORTS_SVG){var a4=function(bh,bd,bg,bf,bc){var be="";if(aZ&&bc.groupId!==null){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Process Group"></div>'}if(i.SUPPORTS_SVG){be+='<div class="pointer show-process-group-status-history fa fa-area-chart" title="View Status History"></div>'}if(av){be+='<div class="pointer show-cluster-process-group-summary fa fa-cubes" title="View Process Group Details"></div>'}return be};S.push({id:"actions",name:"&nbsp;",formatter:a4,resizable:false,sortable:false,width:75,maxWidth:75})}var ai={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var ax=new x.Data.DataView({inlineFilters:false});ax.setItems([]);ax.setFilterArgs({searchString:"",property:"name"});ax.setFilter(l);A("process-group-summary-table",{columnId:"name",sortAsc:true},ax);var aU=new x.Grid("#process-group-summary-table",ax,S,ai);aU.setSelectionModel(new x.RowSelectionModel());aU.registerPlugin(new x.AutoTooltips());aU.setSortColumn("name",true);aU.onSort.subscribe(function(bd,bc){A("process-group-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},ax)});aU.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=ax.getItem(bc.row);if(aU.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){if(i.isDefinedAndNotNull(parent.nf)&&i.isDefinedAndNotNull(parent.nf.ProcessGroup)&&i.isDefinedAndNotNull(parent.nf.Shell)){parent.nf.ProcessGroup.enterGroup(bd.id);parent.$("#shell-close-button").click()}}else{if(be.hasClass("show-process-group-status-history")){c.showProcessGroupChart(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-process-group-summary")){o(bd.id);e("#summary-loading-container").hide();e("#cluster-process-group-summary-dialog").modal("show");aa.resizeCanvas()}}}}});ax.onRowCountChanged.subscribe(function(bd,bc){aU.updateRowCount();aU.render();if(e("#process-group-summary-table").is(":visible")){e("#displayed-items").text(i.formatInteger(bc.current))}});ax.onRowsChanged.subscribe(function(bd,bc){aU.invalidateRows(bc.rows);aU.render()});e("#process-group-summary-table").data("gridInstance",aU).on("mouseenter","div.slick-cell",function(bh){var be=e(this).find("div.has-bulletins");if(be.length&&!be.data("qtip")){var bc=e(this).find("span.row-id").text();var bd=ax.getItemById(bc);var bg=i.getFormattedBulletins(bd.bulletins);var bf=i.formatUnorderedList(bg);if(i.isDefinedAndNotNull(bf)){be.qtip(e.extend({},i.config.tooltipConfig,{content:bf,position:{container:e("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});e("#cluster-process-group-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Process Group Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-process-group-id").text("");e("#cluster-process-group-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-process-group-refresh-button").click(function(){o(e("#cluster-process-group-id").text())});var ao=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},ag,ay,aF,a7,ad,aK];var aE={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var a1=new x.Data.DataView({inlineFilters:false});a1.setItems([]);A("cluster-processor-summary-table",{columnId:"node",sortAsc:true},a1);var aa=new x.Grid("#cluster-process-group-summary-table",a1,ao,aE);aa.setSelectionModel(new x.RowSelectionModel());aa.registerPlugin(new x.AutoTooltips());aa.setSortColumn("node",true);aa.onSort.subscribe(function(bd,bc){A("cluster-process-group-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},a1)});a1.onRowCountChanged.subscribe(function(bd,bc){aa.updateRowCount();aa.render()});a1.onRowsChanged.subscribe(function(bd,bc){aa.invalidateRows(bc.rows);aa.render()});e("#cluster-process-group-summary-table").data("gridInstance",aa);var ba=[aN,a5,aW,a7];if(av||aZ){var ar=function(bh,bd,bg,bf,bc){var be="";if(aZ){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Input Port"></div>'}if(av){be+='<div class="pointer show-cluster-input-port-summary fa fa-cubes" title="View Input Port Details"></div>'}return be};ba.push({id:"actions",name:"&nbsp;",formatter:ar,resizable:false,sortable:false,width:75,maxWidth:75})}var am={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var M=new x.Data.DataView({inlineFilters:false});M.setItems([]);M.setFilterArgs({searchString:"",property:"name"});M.setFilter(l);A("input-port-summary-table",{columnId:"name",sortAsc:true},M);var al=new x.Grid("#input-port-summary-table",M,ba,am);al.setSelectionModel(new x.RowSelectionModel());al.registerPlugin(new x.AutoTooltips());al.setSortColumn("name",true);al.onSort.subscribe(function(bd,bc){A("input-port-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},M)});al.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=M.getItem(bc.row);if(al.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){F(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-input-port-summary")){v(bd.groupId,bd.id);e("#summary-loading-container").hide();e("#cluster-input-port-summary-dialog").modal("show");aA.resizeCanvas()}}}});M.onRowCountChanged.subscribe(function(bd,bc){al.updateRowCount();al.render();if(e("#input-port-summary-table").is(":visible")){e("#display-items").text(i.formatInteger(bc.current))}});M.onRowsChanged.subscribe(function(bd,bc){al.invalidateRows(bc.rows);al.render()});e("#input-port-summary-table").data("gridInstance",al).on("mouseenter","div.slick-cell",function(bh){var be=e(this).find("div.has-bulletins");if(be.length&&!be.data("qtip")){var bc=e(this).find("span.row-id").text();var bd=M.getItemById(bc);var bg=i.getFormattedBulletins(bd.bulletins);var bf=i.formatUnorderedList(bg);if(i.isDefinedAndNotNull(bf)){be.qtip(e.extend({},i.config.tooltipConfig,{content:bf,position:{container:e("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});e("#cluster-input-port-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Input Port Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-input-port-id").text("");e("#cluster-input-port-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-input-port-refresh-button").click(function(){v(e("#cluster-input-port-group-id").text(),e("#cluster-input-port-id").text())});var ah=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},aW,a7];var aT={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var Y=new x.Data.DataView({inlineFilters:false});Y.setItems([]);A("cluster-input-port-summary-table",{columnId:"node",sortAsc:true},Y);var aA=new x.Grid("#cluster-input-port-summary-table",Y,ah,aT);aA.setSelectionModel(new x.RowSelectionModel());aA.registerPlugin(new x.AutoTooltips());aA.setSortColumn("node",true);aA.onSort.subscribe(function(bd,bc){A("cluster-input-port-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},Y)});Y.onRowCountChanged.subscribe(function(bd,bc){aA.updateRowCount();aA.render()});Y.onRowsChanged.subscribe(function(bd,bc){aA.invalidateRows(bc.rows);aA.render()});e("#cluster-input-port-summary-table").data("gridInstance",aA);var aC=[aN,a5,aW,ay];if(av||aZ){var aO=function(bh,bd,bg,bf,bc){var be="";if(aZ){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Output Port"></div>'}if(av){be+='<div class="pointer show-cluster-output-port-summary fa fa-cubes" title="View Output Port Details"></div>'}return be};aC.push({id:"actions",name:"&nbsp;",formatter:aO,resizable:false,sortable:false,width:75,maxWidth:75})}var at={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var I=new x.Data.DataView({inlineFilters:false});I.setItems([]);I.setFilterArgs({searchString:"",property:"name"});I.setFilter(l);A("output-port-summary-table",{columnId:"name",sortAsc:true},I);var ak=new x.Grid("#output-port-summary-table",I,aC,at);ak.setSelectionModel(new x.RowSelectionModel());ak.registerPlugin(new x.AutoTooltips());ak.setSortColumn("name",true);ak.onSort.subscribe(function(bd,bc){A("output-port-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},I)});ak.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=I.getItem(bc.row);if(ak.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){F(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-output-port-summary")){k(bd.groupId,bd.id);e("#summary-loading-container").hide();e("#cluster-output-port-summary-dialog").modal("show");a9.resizeCanvas()}}}});I.onRowCountChanged.subscribe(function(bd,bc){ak.updateRowCount();ak.render();if(e("#output-port-summary-table").is(":visible")){e("#display-items").text(i.formatInteger(bc.current))}});I.onRowsChanged.subscribe(function(bd,bc){ak.invalidateRows(bc.rows);ak.render()});e("#output-port-summary-table").data("gridInstance",ak).on("mouseenter","div.slick-cell",function(bh){var be=e(this).find("div.has-bulletins");if(be.length&&!be.data("qtip")){var bc=e(this).find("span.row-id").text();var bd=I.getItemById(bc);var bg=i.getFormattedBulletins(bd.bulletins);var bf=i.formatUnorderedList(bg);if(i.isDefinedAndNotNull(bf)){be.qtip(e.extend({},i.config.tooltipConfig,{content:bf,position:{container:e("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});e("#cluster-output-port-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Output Port Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-output-port-id").text("");e("#cluster-output-port-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-output-port-refresh-button").click(function(){k(e("#cluster-output-port-group-id").text(),e("#cluster-output-port-id").text())});var X=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},aW,ay];var ap={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var aL=new x.Data.DataView({inlineFilters:false});aL.setItems([]);A("cluster-output-port-summary-table",{columnId:"node",sortAsc:true},aL);var a9=new x.Grid("#cluster-output-port-summary-table",aL,X,ap);a9.setSelectionModel(new x.RowSelectionModel());a9.registerPlugin(new x.AutoTooltips());a9.setSortColumn("node",true);a9.onSort.subscribe(function(bd,bc){A("cluster-output-port-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},aL)});aL.onRowCountChanged.subscribe(function(bd,bc){a9.updateRowCount();a9.render()});aL.onRowsChanged.subscribe(function(bd,bc){a9.invalidateRows(bc.rows);a9.render()});e("#cluster-output-port-summary-table").data("gridInstance",a9);var ab=function(bk,bi,bh,bf,bc){var bg="";if(i.isDefinedAndNotNull(bc.activeThreadCount)&&bc.activeThreadCount>0){bg="("+i.escapeHtml(bc.activeThreadCount)+")"}var bj="invalid fa fa-warning";var bd="Invalid";if(bh==="Transmitting"){bj="transmitting fa fa-bullseye";bd=bh}else{bj="not-transmitting icon icon-transmit-false";bd="Not Transmitting"}var be='<div layout="row"><div class="'+bj+'"></div>';return be+'<div class="status-text">'+bd+'</div><div style="float: left; margin-left: 4px;">'+i.escapeHtml(bg)+"</div></div>"};var af={id:"transmissionStatus",field:"transmissionStatus",name:"Transmitting",formatter:ab,sortable:true,resizable:true};var aV={id:"targetUri",field:"targetUri",name:"Target URI",sortable:true,resizable:true,formatter:i.genericValueFormatter};var aq=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",resizable:false,formatter:U,sortable:true,width:50,maxWidth:50,toolTip:"Sorts based on presence of bulletins"},a5,aV,af,ad,aK];if(av||aZ||i.SUPPORTS_SVG){var T=function(bh,bd,bg,bf,bc){var be="";if(aZ){be+='<div class="pointer go-to fa fa-long-arrow-right" title="Go To Process Group"></div>'}if(i.SUPPORTS_SVG){be+='<div class="pointer show-remote-process-group-status-history fa fa-area-chart" title="View Status History"></div>'}if(av){be+='<div class="pointer show-cluster-remote-process-group-summary fa fa-cubes" title="View Remote Process Group Details"></div>'}return be};aq.push({id:"actions",name:"&nbsp;",formatter:T,resizable:false,sortable:false,width:75,maxWidth:75})}var aR={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var a0=new x.Data.DataView({inlineFilters:false});a0.setItems([]);a0.setFilterArgs({searchString:"",property:"name"});a0.setFilter(l);A("remote-process-group-summary-table",{columnId:"name",sortAsc:true},a0);var Z=new x.Grid("#remote-process-group-summary-table",a0,aq,aR);Z.setSelectionModel(new x.RowSelectionModel());Z.registerPlugin(new x.AutoTooltips());Z.setSortColumn("name",true);Z.onSort.subscribe(function(bd,bc){A("remote-process-group-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},a0)});Z.onClick.subscribe(function(bf,bc){var be=e(bf.target);var bd=a0.getItem(bc.row);if(Z.getColumns()[bc.cell].id==="actions"){if(be.hasClass("go-to")){F(bd.groupId,bd.id)}else{if(be.hasClass("show-remote-process-group-status-history")){c.showRemoteProcessGroupChart(bd.groupId,bd.id)}else{if(be.hasClass("show-cluster-remote-process-group-summary")){f(bd.groupId,bd.id);e("#summary-loading-container").hide();e("#cluster-remote-process-group-summary-dialog").modal("show");au.resizeCanvas()}}}}});a0.onRowCountChanged.subscribe(function(bd,bc){Z.updateRowCount();Z.render();if(e("#remote-process-group-summary-table").is(":visible")){e("#displayed-items").text(i.formatInteger(bc.current))}});a0.onRowsChanged.subscribe(function(bd,bc){Z.invalidateRows(bc.rows);Z.render()});e("#remote-process-group-summary-table").data("gridInstance",Z).on("mouseenter","div.slick-cell",function(bh){var be=e(this).find("div.has-bulletins");if(be.length&&!be.data("qtip")){var bc=e(this).find("span.row-id").text();var bd=a0.getItemById(bc);var bg=i.getFormattedBulletins(bd.bulletins);var bf=i.formatUnorderedList(bg);if(i.isDefinedAndNotNull(bf)){be.qtip(e.extend({},i.config.tooltipConfig,{content:bf,position:{container:e("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});e("#cluster-remote-process-group-summary-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Cluster Remote Process Group Summary",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#cluster-remote-process-group-id").text("");e("#cluster-remote-process-group-name").text("");this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()}}});e("#cluster-remote-process-group-refresh-button").click(function(){f(e("#cluster-remote-process-group-group-id").text(),e("#cluster-remote-process-group-id").text())});var aQ=[{id:"node",field:"node",name:"Node",sortable:true,resizable:true,formatter:i.genericValueFormatter},aV,af,ad,aK];var N={autosizeColsMode:x.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var Q=new x.Data.DataView({inlineFilters:false});Q.setItems([]);A("cluster-remote-process-group-summary-table",{columnId:"node",sortAsc:true},Q);var au=new x.Grid("#cluster-remote-process-group-summary-table",Q,aQ,N);au.setSelectionModel(new x.RowSelectionModel());au.registerPlugin(new x.AutoTooltips());au.setSortColumn("node",true);au.onSort.subscribe(function(bd,bc){A("cluster-remote-process-group-summary-table",{columnId:bc.sortCol.field,sortAsc:bc.sortAsc},Q)});Q.onRowCountChanged.subscribe(function(bd,bc){au.updateRowCount();au.render()});Q.onRowsChanged.subscribe(function(bd,bc){au.invalidateRows(bc.rows);au.render()});e("#cluster-remote-process-group-summary-table").data("gridInstance",au);e("#system-diagnostics-link").click(function(){t().done(function(){e("#summary-loading-container").hide();e("#system-diagnostics-dialog").modal("show")})});e("#system-diagnostics-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"JVM",tabContentId:"jvm-tab-content"},{name:"System",tabContentId:"system-tab-content"},{name:"Version",tabContentId:"version-tab-content"}]});e("#system-diagnostics-dialog").modal({scrollableContentStyle:"scrollable",headerText:"System Diagnostics",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){e("#summary-loading-container").show()},open:function(){i.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});e("#system-diagnostics-refresh-button").click(function(){t()});e("#total-items").text("0")};var a={};var B=function(I){var H=Math.max(E.get(I,"percentUseBytes",0),E.get(I,"percentUseCount",0));if(H>=100){return 0}var J=E.get(I,"predictions.predictedMillisUntilBytesBackpressure",-1);var K=E.get(I,"predictions.predictedMillisUntilCountBackpressure",-1);if(J<0){return K<0?Number.MAX_VALUE:K}else{if(K<0){return J}}return Math.min(J,K)};var A=function(J,H,K){if(i.isUndefined(a[J])){a[J]={}}var I=function(ak,aj){if(H.columnId==="moreDetails"){var af=0;if(!i.isEmpty(ak.bulletins)){af=ak.bulletins.length}var O=0;if(!i.isEmpty(aj.bulletins)){O=aj.bulletins.length}return af-O}else{if(H.columnId==="runStatus"||H.columnId==="transmissionStatus"){var Z=i.isDefinedAndNotNull(ak[H.columnId])?ak[H.columnId]:"";var X=i.isDefinedAndNotNull(aj[H.columnId])?aj[H.columnId]:"";if(Z===X){return ak.activeThreadCount-aj.activeThreadCount}else{return Z===X?0:Z>X?1:-1}}else{if(H.columnId==="queued"){var am=a[J].count%4;if(am<2){e("#"+J+" span.queued-title").addClass("sorted");var an=i.parseCount(ak.queuedCount);var M=i.parseCount(aj.queuedCount);return an-M}else{e("#"+J+" span.queued-size-title").addClass("sorted");var L=i.parseSize(ak.queuedSize);var T=i.parseSize(aj.queuedSize);return L-T}}else{if(H.columnId==="backpressure"){var am=a[J].count%4;if(am<2){e("#"+J+" span.backpressure-object-title").addClass("sorted");var S=i.isDefinedAndNotNull(ak.percentUseCount)?ak.percentUseCount:-1;var U=i.isDefinedAndNotNull(aj.percentUseCount)?aj.percentUseCount:-1;return S-U}else{e("#"+J+" span.backpressure-data-size-title").addClass("sorted");var ad=i.isDefinedAndNotNull(ak.percentUseBytes)?ak.percentUseBytes:-1;var al=i.isDefinedAndNotNull(aj.percentUseBytes)?aj.percentUseBytes:-1;return ad-al}}else{if(H.columnId==="backpressurePrediction"){var P=B(ak);var ae=B(aj);return P-ae}else{if(H.columnId==="sent"||H.columnId==="received"||H.columnId==="input"||H.columnId==="output"||H.columnId==="transferred"){var ac=ak[H.columnId].split(/\(([^)]+)\)/);var ah=aj[H.columnId].split(/\(([^)]+)\)/);var am=a[J].count%4;if(am<2){e("#"+J+" span."+H.columnId+"-title").addClass("sorted");var R=i.parseCount(ac[0]);var V=i.parseCount(ah[0]);return R-V}else{e("#"+J+" span."+H.columnId+"-size-title").addClass("sorted");var Y=i.parseSize(ac[1]);var Q=i.parseSize(ah[1]);return Y-Q}}else{if(H.columnId==="io"){var am=a[J].count%4;if(am<2){e("#"+J+" span.read-title").addClass("sorted");var ap=i.parseSize(ak.read);var ai=i.parseSize(aj.read);return ap-ai}else{e("#"+J+" span.written-title").addClass("sorted");var W=i.parseSize(ak.written);var ao=i.parseSize(aj.written);return W-ao}}else{if(H.columnId==="tasks"){var am=a[J].count%4;if(am<2){e("#"+J+" span.tasks-title").addClass("sorted");var ab=i.parseCount(ak.tasks);var ag=i.parseCount(aj.tasks);return ab-ag}else{e("#"+J+" span.time-title").addClass("sorted");var N=i.parseDuration(ak.tasksDuration);var aa=i.parseDuration(aj.tasksDuration);return N-aa}}else{var Z=i.isDefinedAndNotNull(ak[H.columnId])?ak[H.columnId]:"";var X=i.isDefinedAndNotNull(aj[H.columnId])?aj[H.columnId]:"";return Z===X?0:Z>X?1:-1}}}}}}}}};e("#"+J+" span.queued-title").removeClass("sorted");e("#"+J+" span.queued-size-title").removeClass("sorted");e("#"+J+" span.backpressure-object-title").removeClass("sorted");e("#"+J+" span.backpressure-data-size-title").removeClass("sorted");e("#"+J+" span.backpressure-prediction-object-title").removeClass("sorted");e("#"+J+" span.backpressure-prediction-data-size-title").removeClass("sorted");e("#"+J+" span.backpressure-prediction-time-title").removeClass("sorted");e("#"+J+" span.input-title").removeClass("sorted");e("#"+J+" span.input-size-title").removeClass("sorted");e("#"+J+" span.output-title").removeClass("sorted");e("#"+J+" span.output-size-title").removeClass("sorted");e("#"+J+" span.read-title").removeClass("sorted");e("#"+J+" span.written-title").removeClass("sorted");e("#"+J+" span.time-title").removeClass("sorted");e("#"+J+" span.tasks-title").removeClass("sorted");e("#"+J+" span.sent-title").removeClass("sorted");e("#"+J+" span.sent-size-title").removeClass("sorted");e("#"+J+" span.received-title").removeClass("sorted");e("#"+J+" span.received-size-title").removeClass("sorted");e("#"+J+" span.transferred-title").removeClass("sorted");e("#"+J+" span.transferred-size-title").removeClass("sorted");if(a[J].prevColumn!==H.columnId){a[J].count=0}else{a[J].count++}K.sort(I,H.sortAsc);a[J].prevColumn=H.columnId};var l=function(I,H){if(H.searchString===""){return true}try{var K=new RegExp(H.searchString,"i")}catch(J){return false}return I[H.property].search(K)>=0};var t=function(){var I=C.urls.systemDiagnostics;var H={};if(!i.isNull(g)){H.clusterNodeId=g}if(!e.isEmptyObject(H)){I+="?"+e.param(H)}return e.ajax({type:"GET",url:I,dataType:"json"}).done(function(N){var S=N.systemDiagnostics;var L=S.aggregateSnapshot;e("#max-heap").text(L.maxHeap);e("#total-heap").text(L.totalHeap);e("#used-heap").text(L.usedHeap);e("#free-heap").text(L.freeHeap);if(i.isDefinedAndNotNull(L.heapUtilization)){e("#utilization-heap").text("("+L.heapUtilization+")")}else{e("#utilization-heap").text("")}e("#max-non-heap").text(L.maxNonHeap);e("#total-non-heap").text(L.totalNonHeap);e("#used-non-heap").text(L.usedNonHeap);e("#free-non-heap").text(L.freeNonHeap);if(i.isDefinedAndNotNull(L.nonHeapUtilization)){e("#utilization-non-heap").text("("+L.nonHeapUtilization+")")}else{e("#utilization-non-heap").text("")}var R=e("#garbage-collection-table tbody").empty();if(i.isDefinedAndNotNull(L.garbageCollection)){var M=L.garbageCollection.sort(function(X,W){return X.name===W.name?0:X.name>W.name?1:-1});e.each(M,function(X,W){s(R,W)})}e("#uptime").text(L.uptime);e("#available-processors").text(L.availableProcessors);if(i.isDefinedAndNotNull(L.processorLoadAverage)){e("#processor-load-average").text(i.formatFloat(L.processorLoadAverage))}else{e("#processor-load-average").html(i.formatValue(L.processorLoadAverage))}var T=e("#flow-file-repository-storage-usage-container").empty();d(T,L.flowFileRepositoryStorageUsage);var P=e("#content-repository-storage-usage-container").empty();if(i.isDefinedAndNotNull(L.contentRepositoryStorageUsage)){var Q=L.contentRepositoryStorageUsage.sort(function(X,W){return X.identifier===W.identifier?0:X.identifier>W.identifier?1:-1});e.each(Q,function(W,X){d(P,X)})}var V=e("#provenance-repository-storage-usage-container").empty();if(i.isDefinedAndNotNull(L.provenanceRepositoryStorageUsage)){var K=L.provenanceRepositoryStorageUsage.sort(function(X,W){return X.identifier===W.identifier?0:X.identifier>W.identifier?1:-1});e.each(K,function(X,W){d(V,W)})}var O={"#version-nifi":L.versionInfo.niFiVersion,"#version-build-tag":L.versionInfo.buildTag,"#version-build-timestamp":L.versionInfo.buildTimestamp,"#version-build-branch":L.versionInfo.buildBranch,"#version-build-revision":L.versionInfo.buildRevision,"#version-java-version":L.versionInfo.javaVersion,"#version-java-vendor":L.versionInfo.javaVendor,"#version-os-name":L.versionInfo.osName,"#version-os-version":L.versionInfo.osVersion,"#version-os-arch":L.versionInfo.osArchitecture};for(var J in O){var U=O[J];if(U){e(J).text(U)}else{e(J).text("(not available)").addClass("unset")}}e("#system-diagnostics-last-refreshed").text(L.statsLastRefreshed)}).fail(h.handleAjaxError)};var s=function(I,H){var K=e("<tr></tr>").appendTo(I);e('<td class="setting-name"></td>').text(H.name+":").appendTo(K);var J=e("<tr></tr>").appendTo(I);e("<td></td>").append(e("<b></b>").text(H.collectionCount+" times ("+H.collectionTime+")")).appendTo(J);e("<tr></tr>").text(" ").appendTo(I)};var d=function(I,L){var K=parseInt(L.totalSpaceBytes,10);var J=parseInt(L.usedSpaceBytes,10);var N=e('<div class="storage-usage"></div>').appendTo(I);var M=e('<div class="storage-identifier setting-name"></div>');M.text("Usage:");if(i.isDefinedAndNotNull(L.identifier)){M.text("Usage for "+L.identifier+":")}M.appendTo(N);(G.injector.get("$compile")(e('<md-progress-linear class="md-hue-2" md-mode="determinate" value="'+(J/K)*100+'" aria-label="FlowFile Repository Storage Usage"></md-progress-linear>'))(G.rootScope)).appendTo(N);var H=e('<div class="storage-usage-details"></div>').text(" ("+L.usedSpace+" of "+L.totalSpace+")").prepend(e("<b></b>").text(Math.round((J/K)*100)+"%"));e('<div class="storage-usage-header"></div>').append(H).append('<div class="clear"></div>').appendTo(N)};var z=function(){return e("#summary-filter").val()};var w=function(O,N,I,M,L,K,J,H){e.each(J.processorStatusSnapshots,function(Q,P){var R=P.processorStatusSnapshot;R.parentProcessGroupName=J.name;R.processGroupNamePath=H.reduce(function(S,T){return S+"/"+T.name},"");O.push(R)});e.each(J.connectionStatusSnapshots,function(P,Q){N.push(Q.connectionStatusSnapshot)});e.each(J.inputPortStatusSnapshots,function(P,Q){M.push(Q.portStatusSnapshot)});e.each(J.outputPortStatusSnapshots,function(P,Q){L.push(Q.portStatusSnapshot)});e.each(J.remoteProcessGroupStatusSnapshots,function(P,Q){K.push(Q.remoteProcessGroupStatusSnapshot)});I.push(J);e.each(J.processGroupStatusSnapshots,function(P,Q){var R=Q.processGroupStatusSnapshot;w(O,N,I,M,L,K,R,j(H,R))})};var j=function(H,J){var I=H.slice();I.push(J);return I};var D=function(){var H;if(e("#processor-summary-table").is(":visible")){H=e("#processor-summary-table").data("gridInstance")}else{if(e("#connection-summary-table").is(":visible")){H=e("#connection-summary-table").data("gridInstance")}else{if(e("#input-port-summary-table").is(":visible")){H=e("#input-port-summary-table").data("gridInstance")}else{if(e("#output-port-summary-table").is(":visible")){H=e("#output-port-summary-table").data("gridInstance")}else{if(e("#process-group-summary-table").is(":visible")){H=e("#process-group-summary-table").data("gridInstance")}else{if(e("#remote-process-group-summary-table").is(":visible")){H=e("#remote-process-group-summary-table").data("gridInstance")}}}}}}if(i.isDefinedAndNotNull(H)){var I=H.getData();I.setFilterArgs({searchString:z(),property:e("#summary-filter-type").combo("getSelectedOption").value});I.refresh()}};var m=function(H,I){e.ajax({type:"GET",url:C.urls.api+"/flow/processors/"+encodeURIComponent(I)+"/status",data:{nodewise:true},dataType:"json"}).done(function(J){if(i.isDefinedAndNotNull(J.processorStatus)){var N=J.processorStatus;var L=e("#cluster-processor-summary-table").data("gridInstance");var M=L.getData();var K=[];e.each(N.nodeSnapshots,function(Q,O){var P=O.statusSnapshot;K.push({id:O.nodeId,node:O.address+":"+O.apiPort,runStatus:P.runStatus,activeThreadCount:P.activeThreadCount,terminatedThreadCount:P.terminatedThreadCount,input:P.input,read:P.read,written:P.written,output:P.output,tasks:P.tasks,tasksDuration:P.tasksDuration})});M.setItems(K);M.reSort();L.invalidate();e("#cluster-processor-name").text(N.name).ellipsis();e("#cluster-processor-type").text(N.aggregateSnapshot.type).ellipsis();e("#cluster-processor-id").text(N.id);e("#cluster-processor-group-id").text(N.groupId);e("#cluster-processor-summary-last-refreshed").text(N.statsLastRefreshed)}}).fail(h.handleAjaxError)};var b=function(H,I){e.ajax({type:"GET",url:C.urls.api+"/flow/connections/"+encodeURIComponent(I)+"/status",data:{nodewise:true},dataType:"json"}).done(function(O){if(i.isDefinedAndNotNull(O.connectionStatus)){var N=O.connectionStatus;var Q=e("#cluster-connection-summary-table").data("gridInstance");var M=Q.getData();var S=[];e.each(N.nodeSnapshots,function(V,T){var U=T.statusSnapshot;S.push({id:T.nodeId,node:T.address+":"+T.apiPort,input:U.input,queued:U.queued,queuedCount:U.queuedCount,queuedSize:U.queuedSize,percentUseCount:U.percentUseCount,percentUseBytes:U.percentUseBytes,predictions:U.predictions,output:U.output})});var R=E.some(S,function(T){return E.isNil(T.predictions)});var L=Q.getColumns();if(R){var K=L.filter(function(T){return T.id!==r.id});Q.setColumns(K)}else{var P=L.findIndex(function(T){return T.id===r.id});if(P<0){var J=L.findIndex(function(T){return T.id==="backpressure"});if(J<0){L.push(r)}else{L.splice(J+1,0,r)}Q.setColumns(L)}}M.setItems(S);M.reSort();Q.invalidate();e("#cluster-connection-name").text(N.name).ellipsis();e("#cluster-connection-type").text("Connection").ellipsis();e("#cluster-connection-id").text(N.id);e("#cluster-connection-group-id").text(N.groupId);e("#cluster-connection-summary-last-refreshed").text(N.statsLastRefreshed)}}).fail(h.handleAjaxError)};var o=function(H){e.ajax({type:"GET",url:C.urls.api+"/flow/process-groups/"+encodeURIComponent(H)+"/status",data:{nodewise:true,recursive:false},dataType:"json"}).done(function(K){if(i.isDefinedAndNotNull(K.processGroupStatus)){var M=K.processGroupStatus;var I=e("#cluster-process-group-summary-table").data("gridInstance");var L=I.getData();var J=[];e.each(M.nodeSnapshots,function(P,N){var O=N.statusSnapshot;J.push({id:N.nodeId,node:N.address+":"+N.apiPort,activeThreadCount:O.activeThreadCount,transferred:O.transferred,input:O.input,queued:O.queued,queuedCount:O.queuedCount,queuedSize:O.queuedSize,output:O.output,read:O.read,written:O.written,sent:O.sent,received:O.received})});L.setItems(J);L.reSort();I.invalidate();e("#cluster-process-group-name").text(M.name).ellipsis();e("#cluster-process-group-type").text("Process Group").ellipsis();e("#cluster-process-group-id").text(M.id);e("#cluster-process-group-summary-last-refreshed").text(M.statsLastRefreshed)}}).fail(h.handleAjaxError)};var v=function(H,I){e.ajax({type:"GET",url:C.urls.api+"/flow/input-ports/"+encodeURIComponent(I)+"/status",data:{nodewise:true},dataType:"json"}).done(function(K){if(i.isDefinedAndNotNull(K.portStatus)){var L=K.portStatus;var J=e("#cluster-input-port-summary-table").data("gridInstance");var M=J.getData();var N=[];e.each(L.nodeSnapshots,function(Q,O){var P=O.statusSnapshot;N.push({id:O.nodeId,node:O.address+":"+O.apiPort,runStatus:P.runStatus,activeThreadCount:P.activeThreadCount,output:P.output})});M.setItems(N);M.reSort();J.invalidate();e("#cluster-input-port-name").text(L.name).ellipsis();e("#cluster-input-port-type").text("Input Port").ellipsis();e("#cluster-input-port-id").text(L.id);e("#cluster-input-port-group-id").text(L.groupId);e("#cluster-input-port-summary-last-refreshed").text(L.statsLastRefreshed)}}).fail(h.handleAjaxError)};var k=function(H,I){e.ajax({type:"GET",url:C.urls.api+"/flow/output-ports/"+encodeURIComponent(I)+"/status",data:{nodewise:true},dataType:"json"}).done(function(K){if(i.isDefinedAndNotNull(K.portStatus)){var J=K.portStatus;var L=e("#cluster-output-port-summary-table").data("gridInstance");var N=L.getData();var M=[];e.each(J.nodeSnapshots,function(Q,O){var P=O.statusSnapshot;M.push({id:O.nodeId,node:O.address+":"+O.apiPort,runStatus:P.runStatus,activeThreadCount:P.activeThreadCount,input:P.input})});N.setItems(M);N.reSort();L.invalidate();e("#cluster-output-port-name").text(J.name).ellipsis();e("#cluster-output-port-type").text("Output Port").ellipsis();e("#cluster-output-port-id").text(J.id);e("#cluster-output-port-group-id").text(J.groupId);e("#cluster-output-port-summary-last-refreshed").text(J.statsLastRefreshed)}}).fail(h.handleAjaxError)};var f=function(I,H){e.ajax({type:"GET",url:C.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(H)+"/status",data:{nodewise:true},dataType:"json"}).done(function(K){if(i.isDefinedAndNotNull(K.remoteProcessGroupStatus)){var N=K.remoteProcessGroupStatus;var L=e("#cluster-remote-process-group-summary-table").data("gridInstance");var M=L.getData();var J=[];e.each(N.nodeSnapshots,function(Q,O){var P=O.statusSnapshot;J.push({id:O.nodeId,node:O.address+":"+O.apiPort,targetUri:P.targetUri,transmissionStatus:P.transmissionStatus,sent:P.sent,received:P.received,activeThreadCount:P.activeThreadCount})});M.setItems(J);M.reSort();L.invalidate();e("#cluster-remote-process-group-name").text(N.name).ellipsis();e("#cluster-remote-process-group-type").text("Remote Process Group").ellipsis();e("#cluster-remote-process-group-id").text(N.id);e("#cluster-remote-process-group-group-id").text(N.groupId);e("#cluster-remote-process-group-summary-last-refreshed").text(N.statsLastRefreshed)}}).fail(h.handleAjaxError)};var g=null;return{init:function(H){return e.Deferred(function(I){var J=e.ajax({type:"GET",url:C.urls.flowConfig,dataType:"json"}).done(function(L){var K=L.flowConfiguration;c.init(K.timeOffset);q.init({supportsGoTo:false,supportsStatusBar:false});p.init();u(H);I.resolve()}).fail(function(){I.reject()})}).promise()},setClusterNodeId:function(H){g=H},resetTableSize:function(){var M=e("#processor-summary-table");if(M.is(":visible")){var Q=M.data("gridInstance");if(i.isDefinedAndNotNull(Q)){Q.resizeCanvas()}}var P=e("#connection-summary-table");if(P.is(":visible")){var L=P.data("gridInstance");if(i.isDefinedAndNotNull(L)){L.resizeCanvas()}}var H=e("#process-group-summary-table");if(H.is(":visible")){var N=H.data("gridInstance");if(i.isDefinedAndNotNull(N)){N.resizeCanvas()}}var S=e("#input-port-summary-table");if(S.is(":visible")){var R=S.data("gridInstance");if(i.isDefinedAndNotNull(R)){R.resizeCanvas()}}var J=e("#output-port-summary-table");if(J.is(":visible")){var O=J.data("gridInstance");if(i.isDefinedAndNotNull(O)){O.resizeCanvas()}}var K=e("#remote-process-group-summary-table");if(K.is(":visible")){var I=K.data("gridInstance");if(i.isDefinedAndNotNull(I)){I.resizeCanvas()}}},loadSummaryTable:function(){var H=C.urls.status;var I={};if(!i.isNull(g)){I.clusterNodeId=g}if(!e.isEmptyObject(I)){H+="?"+e.param(I)}return e.ajax({type:"GET",url:H,data:{recursive:true},dataType:"json"}).done(function(J){var ab=J.processGroupStatus;var P=ab.aggregateSnapshot;if(i.isDefinedAndNotNull(P)){var U=e("#processor-summary-table");i.cleanUpTooltips(U,"div.has-bulletins");var S=U.data("gridInstance");var Q=S.getData();var N=e("#connection-summary-table").data("gridInstance");var L=N.getData();var K=e("#process-group-summary-table");i.cleanUpTooltips(K,"div.has-bulletins");var V=K.data("gridInstance");var T=V.getData();var al=e("#input-port-summary-table");i.cleanUpTooltips(al,"div.has-bulletins");var aj=al.data("gridInstance");var ai=aj.getData();var am=e("#output-port-summary-table");i.cleanUpTooltips(am,"div.has-bulletins");var Y=am.data("gridInstance");var W=Y.getData();var aa=e("#remote-process-group-summary-table");i.cleanUpTooltips(aa,"div.has-bulletins");var ae=aa.data("gridInstance");var ad=ae.getData();var ak=[];var ah=[];var R=[];var ac=[];var an=[];var O=[];w(ak,ah,R,ac,an,O,P,[P]);var af=E.some(ah,function(ao){return E.isNil(ao.predictions)});var M=N.getColumns();if(af){var Z=M.filter(function(ao){return ao.id!==r.id});N.setColumns(Z)}else{var ag=M.findIndex(function(ao){return ao.id===r.id});if(ag<0){var X=M.findIndex(function(ao){return ao.id==="backpressure"});if(X<0){M.push(r)}else{M.splice(X+1,0,r)}N.setColumns(M)}}Q.setItems(ak);Q.reSort();S.invalidate();L.setItems(ah);L.reSort();N.invalidate();T.setItems(R);T.reSort();V.invalidate();ai.setItems(ac);ai.reSort();aj.invalidate();W.setItems(an);W.reSort();Y.invalidate();ad.setItems(O);ad.reSort();ae.invalidate();e("#summary-last-refreshed").text(ab.statsLastRefreshed);if(e("#processor-summary-table").is(":visible")){e("#total-items").text(i.formatInteger(ak.length))}else{if(e("#connection-summary-table").is(":visible")){e("#total-items").text(i.formatInteger(ah.length))}else{if(e("#input-port-summary-table").is(":visible")){e("#total-items").text(i.formatInteger(ac.length))}else{if(e("#output-port-summary-table").is(":visible")){e("#total-items").text(i.formatInteger(an.length))}else{if(e("#process-group-summary-table").is(":visible")){e("#total-items").text(i.formatInteger(R.length))}else{e("#total-items").text(i.formatInteger(O.length))}}}}}}else{e("#total-items").text("0")}}).fail(h.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.SummaryTable"],function(d,e,c,f){return(nf.ClusterSearch=b(d,e,c,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSearch=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.SummaryTable")))}else{nf.ClusterSearch=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.SummaryTable)}}}(this,function(c,d,b,e){var a={search:"Search nodes",urls:{clusterSearch:"../nifi-api/flow/cluster/search-results"}};return{init:function(){c("#view-single-node-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Select node",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var f=c("#cluster-search-field").val();c.ajax({type:"GET",data:{q:f},dataType:"json",url:a.urls.clusterSearch}).done(function(g){var i=g.nodeResults;var h=function(k){e.setClusterNodeId(k.id);e.loadSummaryTable();c("#summary-header-text").text(k.address+" Summary")};if(!c.isArray(i)||i.length===0){b.showOkDialog({headerText:"Cluster Search",dialogContent:"No nodes match '"+d.escapeHtml(f)+"'."})}else{if(i.length>1){var j=false;c.each(i,function(l,k){if(k.address===f){h(k);j=true;return false}});if(j){c("#view-single-node-dialog").modal("hide")}else{b.showOkDialog({headerText:"Cluster Search",dialogContent:"More than one node matches '"+d.escapeHtml(f)+"'."})}}else{if(i.length===1){h(i[0]);c("#view-single-node-dialog").modal("hide")}}}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){c("#cluster-search-field").val(a.search).addClass("search-nodes").clusterSearchAutocomplete("reset")}}});c.widget("nf.clusterSearchAutocomplete",c.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(g){var f=[];f.push(g);return f},_renderMenu:function(h,f){var i=f[0];var g=this;c.each(i.nodeResults,function(j,k){g._renderItem(h,{label:k.address,value:k.address})});if(h.children().length===0){h.append('<li class="unset search-no-matches">No nodes matched the search terms</li>')}},_resizeMenu:function(){var f=this.menu.element;f.width(c("#cluster-search-field").outerWidth()-2)},_renderItem:function(g,f){var h=c("<a></a>").text(f.label);return c("<li></li>").data("ui-autocomplete-item",f).append(h).appendTo(g)}});c("#cluster-search-field").clusterSearchAutocomplete({minLength:0,appendTo:"#search-cluster-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(g,f){c.ajax({type:"GET",data:{q:g.term},dataType:"json",url:a.urls.clusterSearch}).done(function(h){f(h)})}}).focus(function(){if(c(this).val()===a.search){c(this).val("").removeClass("search-nodes")}}).val(a.search).addClass("search-nodes");c("#view-single-node-link").click(function(){c("#view-single-node-dialog").modal("show");c("#cluster-search-field").focus()});c("#view-cluster-link").click(function(){e.setClusterNodeId(null);e.loadSummaryTable();c("#summary-header-text").text("NiFi Summary")});c("#view-options-container").show()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.ClusterSummary","nf.ClusterSearch","nf.ng.AppConfig","nf.ng.AppCtrl","nf.ng.ServiceProvider","nf.ng.Bridge","nf.ErrorHandler","nf.Storage","nf.SummaryTable"],function(f,l,e,k,n,o,j,d,c,h,i,g,m){return(nf.Summary=b(f,l,e,k,n,o,j,d,h,i,g,m))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Summary=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.ClusterSearch"),require("nf.ng.AppConfig"),require("nf.ng.AppCtrl"),require("nf.ng.ServiceProvider"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.SummaryTable")))}else{nf.Summary=b(a.$,a.angular,a.nf.Common,a.nf.ClusterSummary,a.nf.ClusterSearch,a.nf.ng.AppConfig,a.nf.ng.AppCtrl,a.nf.ng.ServiceProvider,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.Storage,a.nf.SummaryTable)}}}(this,function(e,m,d,k,o,p,j,c,g,i,f,n){e(document).ready(function(){var q=m.module("ngSummaryApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);p.$inject=["$mdThemingProvider","$compileProvider"];j.$inject=["$scope","serviceProvider"];c.$inject=[];q.config(p);q.controller("ngSummaryAppCtrl",j);q.service("serviceProvider",c);g.injector=m.bootstrap(e("body"),["ngSummaryApp"],{strictDi:true});k.loadClusterSummary().done(function(){h.init()})});var b={urls:{banners:"../nifi-api/flow/banners",about:"../nifi-api/flow/about",clusterSummary:"../nifi-api/flow/cluster/summary"}};var l=function(){return e.Deferred(function(q){e.ajax({type:"GET",url:b.urls.clusterSummary}).done(function(r){n.init(r.clusterSummary.connectedToCluster).done(function(){if(r.clusterSummary.connectedToCluster){o.init()}q.resolve()}).fail(function(){q.reject()})}).fail(i.handleAjaxError)}).promise()};var a=function(){e("#refresh-button").click(function(){k.loadClusterSummary().done(function(){n.loadSummaryTable()})});return e.Deferred(function(q){if(top===window){e.ajax({type:"GET",url:b.urls.banners,dataType:"json"}).done(function(v){if(d.isDefinedAndNotNull(v.banners)){if(d.isDefinedAndNotNull(v.banners.headerText)&&v.banners.headerText!==""){var s=e("#banner-header").text(v.banners.headerText).show();var u=function(w){var x=e("#"+w);x.css("top",(parseInt(s.css("height"),10)+parseInt(x.css("top"),10))+"px")};u("summary")}if(d.isDefinedAndNotNull(v.banners.footerText)&&v.banners.footerText!==""){var r=e("#banner-footer").text(v.banners.footerText).show();var t=function(w){var x=e("#"+w);x.css("bottom",parseInt(r.css("height"),10)+"px")};t("summary")}}q.resolve()}).fail(function(t,r,s){i.handleAjaxError(t,r,s);q.reject()})}else{q.resolve()}}).promise()};var h={init:function(){f.init();l().done(function(){n.loadSummaryTable().done(function(){a().done(function(){var q=function(){if(top===window){e("body").css({height:e(window).height()+"px",width:e(window).width()+"px"});e("#summary").css("margin",40);e("div.summary-table").css("bottom",127);e("#flow-summary-refresh-container").css({position:"absolute",bottom:"0px",margin:"40px"})}n.resetTableSize()};e.ajax({type:"GET",url:b.urls.about,dataType:"json"}).done(function(s){var r=s.about;var t=r.title+" Summary";document.title=t;e("#status-header-text").text(t);q()}).fail(i.handleAjaxError);e(window).on("resize",function(y){q();var r=e(".dialog");for(var w=0,x=r.length;w<x;w++){if(e(r[w]).is(":visible")){setTimeout(function(A){A.modal("resize")},50,e(r[w]))}}var z=e('*[class*="slickgrid_"]');for(var v=0,x=z.length;v<x;v++){if(e(z[v]).is(":visible")){setTimeout(function(A){A.data("gridInstance").resizeCanvas()},50,e(z[v]))}}var t=e(".tab-container");var s=[];for(var u=0,x=t.length;u<x;u++){if(e(t[u]).is(":visible")){s.push(e("#"+e(t[u]).attr("id")+"-content"))}}e.each(s,function(A,B){d.toggleScrollable(B.get(0))})})})})})}};return h}));
